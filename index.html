<!DOCTYPE html>
<html lang="pt-br">
<head>
    <title>Mapa RPG Interativo 8K</title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    
    <style>
    /* --- ESTILOS GERAIS --- */
    
    /* Fundo Azul Escolhido (#4F686E) */
    body { margin: 0; background: #4F686E; overflow: hidden; font-family: sans-serif; }
    #map { height: 100vh; width: 100vw; z-index: 1; background: #4F686E; }

    /* MENU LATERAL (PRETO) */
    #menu-provincias {
        position: fixed;
        top: 20px; right: 20px;
        width: 220px;
        background: rgba(26, 26, 26, 0.95); 
        border: 2px solid #8b4513;
        border-radius: 8px;
        color: white;
        z-index: 2000;
        padding: 15px;
        box-shadow: 0 0 15px rgba(0,0,0,0.8);
        transition: 0.3s;
    }

    #menu-provincias h3 {
        text-align: center;
        margin-top: 0;
        color: #cd853f;
        border-bottom: 1px solid #555;
        padding-bottom: 10px;
        cursor: pointer;
    }

    #seta-menu { display: none; }
    #lista-botoes-provincia { display: block; }

    .botao-provincia {
        display: block; width: 100%;
        padding: 10px; margin: 5px 0;
        background: transparent; color: #ddd;
        border: 1px solid #444; border-radius: 4px;
        text-align: left; cursor: pointer;
        transition: 0.3s;
    }

    .botao-provincia:hover {
        background: #8b4513; color: white; border-color: #a0522d;
    }

    /* CONTAINER DA FOTO EST√ÅTICA */
    #provincia-container {
        display: none;
        background: #4F686E; 
        height: 100vh; width: 100vw; 
        position: fixed; top: 0; left: 0;
        z-index: 3000;
        flex-direction: column;
        align-items: center; justify-content: center;
    }

    #img-provincia {
        max-height: 85vh; max-width: 90vw;
        object-fit: contain;
        box-shadow: 0 0 50px rgba(0,0,0,1);
        border: 2px solid #333;
    }

    /* POPUPS E BOT√ïES */
    .leaflet-popup-content-wrapper { background: #2c2c2c; color: #fff; font-size: 14px; }
    .leaflet-popup-tip { background: #2c2c2c; }
    
    .btn-popup {
        background: #8b4513; color: white; border: none;
        padding: 8px 12px; border-radius: 3px;
        cursor: pointer; font-weight: bold;
    }

    /* MODAL DE DETALHES */
    #modal-info {
        position: fixed; z-index: 5000; left: 0; top: 0;
        width: 100%; height: 100%;
        background-color: rgba(0,0,0,0.8);
        display: flex; align-items: center; justify-content: center;
    }

    .modal-conteudo {
        background-color: #2c2c2c; border: 2px solid #cd853f;
        width: 60%; max-width: 800px; max-height: 80vh;
        overflow-y: auto; padding: 30px; border-radius: 10px;
        color: #ddd; font-family: serif; box-shadow: 0 0 20px #cd853f;
        position: relative;
    }
    .modal-conteudo h2 { color: #cd853f; border-bottom: 1px solid #555; padding-bottom: 10px; margin-top: 0; }
    .modal-conteudo p { line-height: 1.6; font-size: 18px; }
    .modal-conteudo strong { color: #ffdead; }
    .fechar-modal { color: #aaa; float: right; font-size: 28px; font-weight: bold; cursor: pointer; }

    /* --- AJUSTES PARA CELULAR --- */
    @media only screen and (max-width: 600px) {
        #menu-provincias {
            width: auto !important;
            right: 10px !important; top: 10px !important;
            padding: 10px; max-width: 70vw; 
        }
        #menu-provincias h3 { margin: 0; padding-bottom: 0; border-bottom: none; font-size: 14px; }
        #seta-menu { display: inline; margin-left: 5px; }
        #lista-botoes-provincia { 
            display: none; 
            margin-top: 10px; border-top: 1px solid #555; padding-top: 5px;
        }
        .modal-conteudo { width: 90% !important; padding: 15px !important; }
        #img-provincia { max-height: 70vh !important; max-width: 95vw !important; }
        
        /* Ajuste do bot√£o de voltar para ficar no topo, abaixo do zoom */
        .leaflet-control-button-voltar {
            margin-top: 10px !important; 
        }
    }
    /* --- NOVOS ESTILOS PARA O MENU DA CAPITAL --- */
    #modal-capital {
        position: fixed; z-index: 5000; left: 0; top: 0; width: 100%; height: 100%;
        background-color: rgba(0,0,0,0.85); display: none; align-items: center; justify-content: center;
    }
    
    /* Estilo da lista de membros/procurados */
    .item-menu { 
        border-bottom: 1px solid #444; padding: 15px 0; display: flex; align-items: flex-start; 
    }
    .item-menu:last-child { border-bottom: none; }
    
    .foto-placeholder { 
        width: 80px; height: 110px; background: #3d3d3d; border: 1px solid #8b4513; 
        margin-right: 15px; flex-shrink: 0; display: flex; 
        align-items: center; justify-content: center; font-size: 10px; color: #777; 
    }
    
    .texto-item h4 { margin: 0 0 5px 0; color: #ffdead; font-size: 18px; }
    .texto-item p { font-size: 14px; margin: 0; color: #ccc; }
    .recompensa { color: #ffd700; font-weight: bold; display: block; margin-bottom: 5px; }
    .classe-char { color: #cd853f; font-weight: bold; font-size: 12px; text-transform: uppercase; display: block; margin-bottom: 5px; }
    </style>
</head>
<body>
    <div id="map-container">
        <div id="map"></div>
    </div>

    <div id="modal-info" style="display: none;">
        <div class="modal-conteudo">
            <span class="fechar-modal" onclick="fecharModalInfo()">&times;</span>
            <h2 id="titulo-provincia">T√≠tulo</h2>
            <div id="texto-provincia"></div>
        </div>
    </div>
    <div id="modal-capital">
        <div class="modal-conteudo">
            <span class="fechar-modal" onclick="fecharModais()">&times;</span>
            <h2 id="titulo-menu-capital" style="color: #cd853f; border-bottom: 1px solid #555;">Capital</h2>
            <div id="conteudo-menu-capital">
                </div>
        </div>
    </div>

    <div id="menu-provincias">
        <h3 onclick="alternarMenuMobile()">Prov√≠ncias <span id="seta-menu">‚ñº</span></h3>
        <div id="lista-botoes-provincia">
            <button class="botao-provincia" onclick="abrirMapaProvincia('Hukmal_tep.jpg')">Hukmal'tep</button>
            <button class="botao-provincia" onclick="abrirMapaProvincia('Blat_khyr.jpg')">Blat'khyr</button>
            <button class="botao-provincia" onclick="abrirMapaProvincia('Deserto.jpg')">Deserto</button>
            <button class="botao-provincia" onclick="abrirMapaProvincia('Lago.jpg')">Lago</button>
            <button class="botao-provincia" onclick="abrirMapaProvincia('Alcova.jpg')">Alcova</button>
            <button class="botao-provincia" onclick="abrirMapaProvincia('Espinha do Gigante.jpg')">Espinha do Gigante</button>
        </div>
    </div>

    <div id="provincia-container">
        <img id="img-provincia" src="">
    </div>

    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

    <script>
   // --- 1. CONFIGURA√á√ïES T√âCNICAS ---
    const configContinental = { arquivo: 'Mapa teste.png', largura: 7680, altura: 4320, minZoom: -2.0, maxZoom: 3 };
    const configProvincia = { largura: 2048, altura: 1536, minZoom: -1.0, maxZoom: 2 };
    let map; 
    let mapaAtualAtivo = 'continente';

    // --- 2. INICIALIZA√á√ÉO DO MAPA ---
    function inicializarMapa(arquivo, largura, altura, minZoom, maxZoom) {
        if (map) { map.remove(); } 

        const limitesImagem = [[0, 0], [altura, largura]];
        const padding = 1500; 
        const limitesNavegacao = [[-padding, -padding], [altura + padding, largura + padding]];
        
        map = L.map('map', {
            crs: L.CRS.Simple,
            minZoom: minZoom,
            maxZoom: maxZoom,
            maxBounds: limitesNavegacao, 
            maxBoundsViscosity: 0.5,     
            tap: false 
        });

        L.imageOverlay(arquivo, limitesImagem).addTo(map);
        map.fitBounds(limitesImagem);
        
        // Ferramenta de Coordenadas (Popup)
        map.on('click', function(e) {
            const y = e.latlng.lat.toFixed(0);
            const x = e.latlng.lng.toFixed(0);
            L.popup()
                .setLatLng(e.latlng)
                .setContent(`Coordenadas: [${y}, ${x}]`)
                .openOn(map);
            console.log(`[${y}, ${x}]`); 
        });
    }

    // --- 3. L√ìGICA DO MENU CELULAR ---
    function alternarMenuMobile() {
        if (window.innerWidth > 600) return;
        const lista = document.getElementById('lista-botoes-provincia');
        const seta = document.getElementById('seta-menu');
        const estiloAtual = window.getComputedStyle(lista).display;
        if (estiloAtual === 'none') {
            lista.style.display = 'block';
            seta.innerHTML = '‚ñ≤';
        } else {
            lista.style.display = 'none';
            seta.innerHTML = '‚ñº';
        }
    }

    // --- 4. NAVEGA√á√ÉO ---
    function carregarMapaPrincipal() {
        mapaAtualAtivo = 'continente';
        document.getElementById('map-container').style.display = 'block';
        document.getElementById('provincia-container').style.display = 'none';
        document.getElementById('menu-provincias').style.display = 'block';
        
        if (window.innerWidth <= 600) {
            document.getElementById('lista-botoes-provincia').style.display = 'none';
            document.getElementById('seta-menu').innerHTML = '‚ñº';
        } else {
            document.getElementById('lista-botoes-provincia').style.display = 'block';
        }

        inicializarMapa(configContinental.arquivo, configContinental.largura, configContinental.altura, configContinental.minZoom, configContinental.maxZoom);
        adicionarMarcadoresPrincipais();
    }

    // --- 5. BANCO DE DADOS (TEXTOS COMPLETOS RESTAURADOS) ---
    const dadosProvincias = {
        'Hukmal_tep.jpg': {
            titulo: "Hukmal'tep - O Inverno Absoluto",
            descricao: `
                <p><strong>üìú Panorama:</strong> Uma vastid√£o dominada por picos colossais e frio implac√°vel. O vento uiva incessantemente entre os vales profundos, moldando uma paisagem onde apenas os mais resilientes prosperam sob o manto de neve eterna.</p>
                <p><strong>üëë Governan√ßa:</strong> O poder √© partilhado pelo <em>Conselho das Tr√™s Tribos</em> (Felistas, Malistas e Garra do Inverno). N√£o existe um soberano √∫nico, mas sim uma tr√©gua armada e tensa entre os cl√£s.</p>
                <p><strong>üßë‚Äçü§ù‚Äçüßë Habitantes:</strong> Predominantemente composta por Humanos adaptados ao clima severo, An√µes das montanhas e Mesti√ßos que buscam ref√∫gio na isola√ß√£o.</p>
                <p><strong>‚öîÔ∏è Tradi√ß√µes:</strong> Uma cultura que exalta a for√ßa bruta e o instinto de sobreviv√™ncia. A magia √© encarada com profundo ceticismo e desconfian√ßa; estudiosos e acad√™micos s√£o raros e raramente bem-vindos.</p>
                <p><strong>üíé Subsist√™ncia:</strong> A economia gira em torno do com√©rcio de peles ex√≥ticas e subprodutos obtidos da ca√ßa de feras colossais que habitam a regi√£o.</p>
            `
        },
        'Blat_khyr.jpg': {
            titulo: "Blat'khyr - O Ber√ßo da Magia",
            descricao: `
                <p><strong>üìú Panorama:</strong> Um reino onde a realidade √© moldada pelo fluxo m√≠stico. A densidade de mana nesta prov√≠ncia √© t√£o alta que a pr√≥pria fauna e flora sofreram muta√ß√µes m√°gicas, criando cen√°rios de beleza surreal e perigo arcano.</p>
                <p><strong>üëë Governan√ßa:</strong> Embora exista uma linhagem real √©lfica cerimonial, a gest√£o administrativa e pol√≠tica reside nas m√£os do <em>Conselho √âlfico</em>, composto pelos mais experientes anci√£os da ra√ßa.</p>
                <p><strong>üßë‚Äçü§ù‚Äçüßë Habitantes:</strong> Uma popula√ß√£o majoritariamente de Elfos e Humanos com afinidade m√°gica.</p>
                <p><strong>‚öîÔ∏è Tradi√ß√µes:</strong> A sociedade valoriza o intelecto, a eleg√¢ncia est√©tica e a maestria arcana. Existe um forte sentimento de preserva√ß√£o cultural entre os Elfos, que muitas vezes evitam o contato pr√≥ximo com outras ra√ßas para preservar o seu "potencial m√≠stico".</p>
                <p><strong>üíé Subsist√™ncia:</strong> O epicentro do mercado arcano, focado na cria√ß√£o, encantamento e exporta√ß√£o de itens m√°gicos de alt√≠ssima qualidade.</p>
            `
        },
        'Deserto.jpg': {
            titulo: "O Deserto - A Origem do Mundo",
            descricao: `
                <p><strong>üìú Sociedade de Castas:</strong> Uma teocracia r√≠gida baseada no controle da √°gua. No topo est√£o os <strong>Zha-Ruk</strong> (Senhores da Nascente), seguidos pelos <strong>Atarim</strong> (Buscadores de Rel√≠quias) e os ricos <strong>Samum</strong> (Mercadores). A base √© formada pelos <strong>Ghovar</strong> (Trabalhadores) e, √† margem, os temidos <strong>Khali</strong> (Os "Secos" ou intoc√°veis).</p>
                <p><strong>üëë Governan√ßa:</strong> Cidades-estado controladas pelos Zha-Ruk, onde a lei √© ditada pela preserva√ß√£o h√≠drica. Desperdi√ßar √°gua √© punido com a morte ou ex√≠lio.</p>
                <p><strong>üßë‚Äçü§ù‚Äçüßë Ra√ßas Principais:</strong> Humanos, Meio-dem√¥nios, an√µes, mesti√ßos e seres adaptados ao calor extremo.</p>
                <p><strong>‚öîÔ∏è Tradi√ß√µes:</strong> Forte tradi√ß√£o oral e leis de hospitalidade r√≠gidas. As ru√≠nas antigas s√£o consideradas sagradas e perigosas, acess√≠veis apenas aos autorizados.</p>
                <p><strong>üíé Economia:</strong> Extra√ß√£o de especiarias raras, min√©rios e venda de rel√≠quias da "Primeira Era" encontradas nas escava√ß√µes.</p>
            `
        },
        'Lago.jpg': {
            titulo: "O Lago - O Solo Aben√ßoado",
            descricao: `
                <p><strong>üìú Panorama:</strong> Uma regi√£o de serenidade contemplativa, onde a honra se reflete nas √°guas cristalinas do lago sagrado. A arquitetura √© integrada √† natureza, utilizando madeira e pedra em designs orientais cl√°ssicos.</p>
                <p><strong>üëë Governan√ßa:</strong> Uma oligarquia de disnastias que comandam as terras e que governam sob um r√≠gido c√≥digo de honra e lealdade ao trono imperial.</p>
                <p><strong>üßë‚Äçü§ù‚Äçüßë Habitantes:</strong> Humanos e Mesti√ßos.</p>
                <p><strong>‚öîÔ∏è Tradi√ß√µes:</strong> Os costumes s√£o profundamente orientais, valorizando o respeito aos ancestrais, a cerim√¥nia do ch√° e a disciplina das artes marciais e caligrafia. A harmonia e o equil√≠brio espiritual s√£o os pilares da sociedade.</p>
                <p><strong>üíé Subsist√™ncia:</strong> O celeiro do imp√©rio; produz gr√£os finos, seda de alta qualidade e pescados raros encontrados apenas nas profundezas do lago.</p>
            `
        },
        'Alcova.jpg': {
            titulo: "Alcova - O Lar dos Piratas",
            descricao: `
                <p><strong>üìú Descri√ß√£o:</strong> Um arquip√©lago repleto de ba√≠as escondidas, cavernas marinhas e rotas de navega√ß√£o perigosas.</p>
                <p><strong>üëë Governo:</strong> Uma "Confedera√ß√£o Livre" onde a lei √© ditada por quem possui o navio mais r√°pido ou os canh√µes mais fortes.</p>
                <p><strong>üßë‚Äçü§ù‚Äçüßë Ra√ßas Principais:</strong> Uma mistura ca√≥tica de todas as ra√ßas, principalmente aquelas fugindo da lei imperial.</p>
                <p><strong>‚öîÔ∏è Cultura:</strong> Liberdade individual extrema e um c√≥digo de honra duvidoso entre capit√£es.</p>
                <p><strong>üíé Economia:</strong> Pirataria, mercado negro e transporte de mercadorias ex√≥ticas "n√£o taxadas".</p>
            `
        },
        'Espinha do Gigante.jpg': {
            titulo: "Regi√£o Desconhecida",
            descricao: "<p>N√£o h√° registros detalhados sobre esta √°rea nos arquivos imperiais.</p>"
        },
        'default': { 
            titulo: "Regi√£o Desconhecida", 
            descricao: "<p>N√£o h√° registros detalhados sobre esta √°rea nos arquivos imperiais.</p>" 
        }
    };

    // --- DADOS DA CAPITAL (MENU INTERATIVO) ---
    const dadosCapital = {
        esquadrao: [
            { nome: "Nome do Jogador 1", classe: "Guerreiro", desc: "Descri√ß√£o breve..." },
            { nome: "Nome do Jogador 2", classe: "Mago", desc: "Descri√ß√£o breve..." }
        ],
        procurados: [
            { nome: "O Sombra", recompensa: "5.000 Moedas", desc: "Visto nas tavernas." },
            { nome: "Karg, o Bruto", recompensa: "12.000 Moedas", desc: "Extremamente perigoso." }
        ]
    };

    // --- FUN√á√ïES DE INTERFACE (MODAIS CORRIGIDOS) ---
    function menuCapital(tipo) {
        const modal = document.getElementById('modal-capital');
        const container = document.getElementById('conteudo-menu-capital');
        const titulo = document.getElementById('titulo-menu-capital');
        modal.style.display = 'flex';
        container.innerHTML = "";

        if (tipo === 'esquadrao') {
            titulo.innerText = "üõ°Ô∏è Membros do Esquadr√£o";
            dadosCapital.esquadrao.forEach(p => {
                container.innerHTML += `
                    <div class="item-menu">
                        <div class="foto-placeholder">FOTO</div>
                        <div class="texto-item">
                            <h4>${p.nome}</h4>
                            <span class="classe-char">${p.classe}</span>
                            <p>${p.desc}</p>
                        </div>
                    </div>`;
            });
        } else if (tipo === 'procurados') {
            titulo.innerText = "‚ò†Ô∏è Cartazes de Procurados";
            dadosCapital.procurados.forEach(n => {
                container.innerHTML += `
                    <div class="item-menu">
                        <div class="foto-placeholder">WANTED</div>
                        <div class="texto-item">
                            <h4>${n.nome}</h4>
                            <span class="recompensa">üí∞ ${n.recompensa}</span>
                            <p>${n.desc}</p>
                        </div>
                    </div>`;
            });
        }
    }

    // Nova fun√ß√£o que apenas fecha a foto sem resetar o mapa
    function fecharImagem() {
        document.getElementById('provincia-container').style.display = 'none';
        document.getElementById('map-container').style.display = 'block';
        
        // Se estiver no continente, garante que o menu aparece. 
        // Se estiver em prov√≠ncia, o menu continua escondido (como deve ser).
        if (mapaAtualAtivo === 'continente') {
            document.getElementById('menu-provincias').style.display = 'block';
        }
    }

    function fecharModais() { 
        document.getElementById('modal-info').style.display = 'none';
        document.getElementById('modal-capital').style.display = 'none';
    }
    
    // TRUQUE: Isso garante que se o HTML chamar 'fecharModalInfo', ele usa a nova fun√ß√£o
    window.fecharModalInfo = fecharModais;

    function abrirModalInfo() {
        const dados = dadosProvincias[mapaAtualAtivo] || dadosProvincias['default'];
        document.getElementById('titulo-provincia').innerHTML = dados.titulo;
        document.getElementById('texto-provincia').innerHTML = dados.descricao;
        document.getElementById('modal-info').style.display = 'flex';
    }

    function abrirMapaProvincia(arquivo) {
        mapaAtualAtivo = arquivo;
        document.getElementById('menu-provincias').style.display = 'none';
        document.getElementById('map-container').style.display = 'block';
        document.getElementById('provincia-container').style.display = 'none';

        inicializarMapa(arquivo, configProvincia.largura, configProvincia.altura, configProvincia.minZoom, configProvincia.maxZoom);

        // Bot√£o Voltar (Topo Esquerdo)
        const BotaoVoltarControl = L.Control.extend({
            options: { position: 'topleft' },
            onAdd: function() {
                const btn = L.DomUtil.create('button', 'leaflet-control-button-voltar');
                btn.innerHTML = "‚¨Ö Voltar ao Continente";
                btn.style.cssText = "white-space:nowrap; padding:12px 18px; background:#8b4513; color:white; border:2px solid #5e2f0d; border-radius:5px; cursor:pointer; font-weight:bold; font-size:14px; z-index:9999;";
                btn.onclick = function(e) {
                    L.DomEvent.stopPropagation(e);
                    carregarMapaPrincipal();
                };
                return btn;
            }
        });
        map.addControl(new BotaoVoltarControl());

        // Bot√£o Detalhes (Topo Direito)
        const BotaoInfoControl = L.Control.extend({
            options: { position: 'topright' },
            onAdd: function() {
                const btn = L.DomUtil.create('button', '');
                btn.innerHTML = "üìú Detalhes";
                btn.style.cssText = "white-space:nowrap; padding:10px 15px; background:#2c3e50; color:#cd853f; border:2px solid #cd853f; border-radius:5px; cursor:pointer; font-weight:bold;";
                btn.onclick = abrirModalInfo;
                return btn;
            }
        });
        map.addControl(new BotaoInfoControl());

        adicionarMarcadoresLocais(arquivo);
    }

function verImagemEstatica(arquivo) {
        // Esconde o mapa (mas ele continua vivo no fundo)
        document.getElementById('map-container').style.display = 'none';
        document.getElementById('menu-provincias').style.display = 'none'; // Esconde menu pra n√£o atrapalhar a foto
        document.getElementById('provincia-container').style.display = 'flex'; 
        document.getElementById('img-provincia').src = arquivo;
        
        const btnVoltarImg = document.createElement('button');
        btnVoltarImg.innerHTML = "‚¨Ö Voltar";
        btnVoltarImg.className = "btn-popup";
        // Ajustado para o topo
        btnVoltarImg.style.cssText = "position: absolute; top: 20px; left: 20px; font-size: 16px; z-index: 4000; padding: 10px 20px;";
        
        // AQUI EST√Å A MUDAN√áA M√ÅGICA:
        btnVoltarImg.onclick = fecharImagem; 
        
        const container = document.getElementById('provincia-container');
        const btnAntigo = container.querySelector('button');
        if (btnAntigo) container.removeChild(btnAntigo);
        container.insertBefore(btnVoltarImg, container.firstChild);
    }

    function voltarParaMapa() {
        if (mapaAtualAtivo === 'continente') carregarMapaPrincipal();
        else abrirMapaProvincia(mapaAtualAtivo);
    }

    // --- 6. MARCADORES LOCAIS ---
    function adicionarMarcadoresLocais(nomeDoMapa) {
        const iconP = L.icon({iconUrl: 'https://unpkg.com/leaflet@1.9.4/dist/images/marker-icon.png', iconSize: [50, 50], iconAnchor: [25, 25], popupAnchor: [0, -25]});
        const iconG = L.icon({iconUrl: 'https://unpkg.com/leaflet@1.9.4/dist/images/marker-icon.png', iconSize: [100, 100], iconAnchor: [50, 50], popupAnchor: [0, -50]});

        // Fun√ß√£o interna para criar os pontos
        function criarPontoLocal(coord, nome, info, foto = null, grande = false) {
            const m = L.marker(coord, {icon: grande ? iconG : iconP, opacity: 0}).addTo(map);
            let popupHtml = `<div style="text-align:center;"><b>${nome}</b><br><small>${info}</small>`;
            if (foto) {
                popupHtml += `<div style="margin-top: 10px;"><button onclick="verImagemEstatica('${foto}')" class="btn-popup">Ver Foto</button></div>`;
            }
            popupHtml += `</div>`;
            m.bindPopup(popupHtml);
        }

        if (nomeDoMapa === 'Hukmal_tep.jpg') {
            criarPontoLocal([1396, 780], "Capital de Hukmal'tep", "Felista", "C√≥pia de capital de hukmal_tep.png", true);
            criarPontoLocal([1422, 441], "Torre de Vigia", "Felista");
            criarPontoLocal([1209, 520], "Torre de Vigia", "Felista");
            criarPontoLocal([1488, 1081], "Torre de Vigia", "Felista");
            criarPontoLocal([1222, 1158], "Torre de Vigia", "Felista");
            criarPontoLocal([1474, 546], "Porto", "Felista");
            criarPontoLocal([1256, 1129], "Vilarejo", "Felista");
            criarPontoLocal([1106, 505], "Vilarejo", "Felista");
            criarPontoLocal([157, 267], "Cidade", "Garra do Inverno");
            criarPontoLocal([419, 483], "Vilarejo", "Garra do Inverno");
            criarPontoLocal([242, 1338], "Vilarejo", "Garra do Inverno", "C√≥pia de cidade ponte.png", true);
            criarPontoLocal([369, 868], "Vilarejo", "Garra do inverno", "C√≥pia de Cidade neve 3.png", true);
            criarPontoLocal([268, 1472], "Torre de Vigia", "Malista");
            criarPontoLocal([513, 1617], "Cidade", "Malista", "C√≥pia de Cidade neve 5.png", true);
            criarPontoLocal([534, 1918], "Vilarejo", "Malista");
            criarPontoLocal([530, 1710], "Porto", "Malista");
            criarPontoLocal([678, 101], "Porto", "Malista");
            criarPontoLocal([707, 1520], "Vilarejo", "Malista");
            criarPontoLocal([659, 1127], "Vilarejo", "Malista", "C√≥pia de Cidade neve 4.png", true);
            criarPontoLocal([796, 1134], "Torre de Vigia", "Malista");
            criarPontoLocal([960, 1733], "Torre de Vigia", "Malista");
            criarPontoLocal([1113, 1460], "Vilarejo", "Malista");
            criarPontoLocal([1003, 172], "Vilarejo", "Malista");
            criarPontoLocal([673, 640], "Vilarejo", "Malista", "C√≥pia de cidade drag√£o.png", true);
            criarPontoLocal([621, 358], "Torre de Vigia", "Malista");
            criarPontoLocal([740, 452], "Torre de Vigia", "Malista");
            criarPontoLocal([713, 257], "Cidade Malista", "Malista", "C√≥pia de Cidade portuaria gelo.png", true);
            criarPontoLocal([141, 578], "Vilarejo", "Neutro", "inicial.png", true);
            criarPontoLocal([1184, 1014], "Vilarejo", "Neutro");
        }

        if (nomeDoMapa === 'Blat_khyr.jpg') {
            criarPontoLocal([382, 1359], "Capital de Blat'khyr", "Elfos", "cidade magica.png", true);
            criarPontoLocal([986, 1239], "Vilarejo", "Desconhecido");
            criarPontoLocal([1091, 606], "Vilarejo", "Desconhecido");
            criarPontoLocal([1463, 1151], "Vilarejo", "Desconhecido");
            criarPontoLocal([491, 371], "Cidade", "Elfos", "Cidade portu√°ria 4.png", true);
            criarPontoLocal([741, 963], "Cidade", "Elfos", "Cidade portu√°ria.png", true);
            criarPontoLocal([621, 1760], "Cidade", "Elfos", "Cidade portu√°ria 2.png", true);
            criarPontoLocal([69, 1054], "Cidade", "Elfos", "Cidade portu√°ria 3.png", true);
            criarPontoLocal([408, 745], "Cidade", "Elfos", "Cidade portu√°ria 5.webp", true);
            criarPontoLocal([252, 891], "Cidade", "Elfos", "Cidade portu√°ria 6.jpg", true);
            criarPontoLocal([611, 1210], "Vilarejo", "Humanos", "Vila.png", true);
            criarPontoLocal([530, 1149], "Vilarejo", "Humanos");
            criarPontoLocal([556, 850], "Vilarejo", "Humanos");
            criarPontoLocal([641, 641], "Vilarejo", "Humanos");
            criarPontoLocal([256, 1302], "Vilarejo", "Humanos");
            criarPontoLocal([500, 1644], "Vilarejo", "Humanos");
            criarPontoLocal([273, 1366], "Cidade", "Elfos");
            criarPontoLocal([824, 894], "Muralha", "Elfos");
            criarPontoLocal([791, 648], "Muralha", "Elfos");
            criarPontoLocal([766, 388], "Muralha", "Elfos");
            criarPontoLocal([884, 1094], "Muralha", "Elfos");
            criarPontoLocal([882, 1271], "Muralha", "Elfos");
        }
         if (nomeDoMapa === 'Deserto.jpg') {
            criarPontoLocal([240, 762], "Capital do Deserto", "Zha-Ruk", "Capital deserto.png", true);
            criarPontoLocal([1314, 588], "Vilarejo", "Ghovar", "Vila deserto.png", true);
            criarPontoLocal([1422, 1582], "Vilarejo", "Ghovar", "Vila de areia.png", true);
            criarPontoLocal( [1256, 126], "Minera√ß√£o", "Ghovar");
            criarPontoLocal( [1436, 112], "Minera√ß√£o", "Abandonada");
            criarPontoLocal( [1362, 400], "Minera√ß√£o", "Ghovar");
            criarPontoLocal( [1247, 730], "Minera√ß√£o", "Ghovar");
            criarPontoLocal( [1213, 846], "Minera√ß√£o", "Ghovar");
            criarPontoLocal( [1256, 126], "Minera√ß√£o", "Ghovar");
            criarPontoLocal( [1408, 1727], "Minera√ß√£o", "Abandonada");
            criarPontoLocal( [1363, 1855], "Minera√ß√£o", "Ghovar");
            criarPontoLocal( [1217, 1298], "Minera√ß√£o", "Abandonada");
            criarPontoLocal( [1149, 1784], "Minera√ß√£o", "Abandonada");
            criarPontoLocal(  [1049, 1809], "Minera√ß√£o", "Abandonada");
            criarPontoLocal( [1142, 1921], "Minera√ß√£o", "Abandonada");
            criarPontoLocal( [693, 1510], "Minera√ß√£o", "Ghovar");
            criarPontoLocal( [871, 1533], "Minera√ß√£o", "Ghovar");
            criarPontoLocal( [786, 1775], "Minera√ß√£o", "Ghovar");
            criarPontoLocal( [1032, 365], "Minera√ß√£o", "Ghovar");
            criarPontoLocal( [990, 617], "Minera√ß√£o", "Ghovar");
            criarPontoLocal(  [808, 580], "Minera√ß√£o", "Ghovar");
            criarPontoLocal(  [813, 399], "Minera√ß√£o", "Ghovar");
            criarPontoLocal( [475, 566], "Minera√ß√£o", "Abandonada");
            criarPontoLocal( [326, 539], "Minera√ß√£o", "Abandonada");
            criarPontoLocal( [401, 376], "Minera√ß√£o", "Ghovar");
        
            criarPontoLocal([1082, 1619], "Cidade", "Samum", "Cidade an√£.png", true);
            criarPontoLocal([1434, 312], "Cidade", "Samum", "Cidade deserto.png", true);
            criarPontoLocal([1082, 146], "Cidade", "Samum", "Cidade deserto 2.png", true);
            criarPontoLocal( [752, 536], "Cidade", "Samum", "Cidade enterrada 2.png", true);
            criarPontoLocal( [148, 170], "Cidade", "Samum");
            criarPontoLocal( [188, 1910], "Cidade", "Samum");

            criarPontoLocal( [1394, 814], "Ru√≠nas", "Atarim", "Entrada deserto.png", true);
            criarPontoLocal( [920, 662], "Ru√≠nas", "Atarim", "paisagem.png", true);
            criarPontoLocal( [660, 1652], "Ru√≠nas", "Atarim");
            criarPontoLocal(  [1310, 1502], "Ru√≠nas", "Atarim");

            criarPontoLocal( [792, 912], "Castelo", "Zha-Ruk", "Castelo deserto 1.png", true);
            criarPontoLocal( [1394, 915], "Castelo", "Zha-Ruk", "Castelo deserto 2.png", true);
            criarPontoLocal( [332, 1278], "Castelo", "Zha-Ruk");
            criarPontoLocal( [1020, 1188], "Castelo", "Zha-Ruk");
            criarPontoLocal( [1210, 1118], "Torre de Vigia", "Zha-Ruk");
            criarPontoLocal(  [1432, 1196], "Torre de Vigia", "Zha-Ruk");

        }
         if (nomeDoMapa === 'Lago.jpg') {
            criarPontoLocal( [970, 1152], "Templo do Lago", "Guardi√µes do Templo", "Templo do lago.png", true);
            criarPontoLocal( [1366, 1578], "Cidade Sagrada", "Igreja dos 12 Deuses", "Cidade Santa.png", true);
            criarPontoLocal( [1336, 1740], "Cidade Sagrada", "Igreja dos 12 Deuses", "Cidade Santa.png", true);
            criarPontoLocal([446, 1336], "Vilarejo", "Dinastia Xogum");
            criarPontoLocal( [180, 912], "Cidade", "Dinastia Xogum", "cidade lago 1.png", true); //imagem com porto
            criarPontoLocal([898, 1908], "Cidade", "Dinastia Kemono", "capital do lago.png", true); 
            criarPontoLocal([726, 1366], "Cidade", "Dinastia Kemono", "cidade lago 2.png", true); //imagem beira do lago
            criarPontoLocal([948, 1672], "Vilarejo", "Dinastia Kemono");
            criarPontoLocal([980, 818], "Cidade", "Dinastia Kitsune", "cidade na montanha.png", true); //imagem beira do lago
            criarPontoLocal([1014, 92], "Vilarejo", "Dinastia Kitsune", "vilarejo na montanha.png", true);
            criarPontoLocal( [610, 706], "Vilarejo", "Dinastia Kitsune");
            criarPontoLocal( [1190, 532], "Vilarejo", "Dinastia Kitsune", "templo.png", true);
            criarPontoLocal( [1400, 192], "Vilarejo", "Dinastia Kitsune");
            criarPontoLocal( [1370, 1016], "Vilarejo", "Dinastia Kitsune");
            criarPontoLocal( [534, 400], "Vilarejo", "Dinastia Seilor");
            criarPontoLocal( [786, 460], "Cidade", "Dinastia Seilor", "cidade lago 3.png", true); //imagem com porto

 
        }

         if (nomeDoMapa === 'Alcova.jpg') {
            criarPontoLocal( [1326, 782], "Torre de Vigia", "Marinha Imperial");
            criarPontoLocal( [1175, 1185], "Torre de Vigia", "Marinha Imperial");
            criarPontoLocal( [1228, 1740], "Torre de Vigia", "Marinha Imperial");
            criarPontoLocal( [724, 650], "Torre de Vigia", "Marinha Imperial");
            criarPontoLocal( [850, 1007], "Torre de Vigia", "Marinha Imperial");
            criarPontoLocal(  [835, 1426], "Torre de Vigia", "Marinha Imperial");
            criarPontoLocal(  [778, 1526], "Torre de Vigia", "Marinha Imperial");

            criarPontoLocal(  [1333, 845], "Cidade", "Desconhecido");
            criarPontoLocal(  [1178, 1137], "Cidade", "Desconhecido");
            criarPontoLocal(  [1191, 1770], "Cidade", "Desconhecido");
            criarPontoLocal(  [637, 1817], "Cidade", "Desconhecido");
            criarPontoLocal(   [565, 1781], "Cidade", "Desconhecido");
            criarPontoLocal(  [814, 1010], "Cidade", "Desconhecido");
            criarPontoLocal(   [775, 643], "Cidade", "Desconhecido");
            criarPontoLocal(   [693, 612], "Cidade", "Desconhecido");
            criarPontoLocal(  [570, 285], "Cidade", "Desconhecido");
            criarPontoLocal(   [210, 344], "Cidade", "Desconhecido");
            criarPontoLocal(  [344, 1175], "Cidade", "Desconhecido");
            criarPontoLocal(   [1133, 536], "Cidade", "Desconhecido");
            criarPontoLocal(    [994, 437], "Cidade", "Desconhecido");

            criarPontoLocal( [904, 269], "Cidade", "Desconhecido", "Cidade pirata.png", true);
            criarPontoLocal(  [333, 1571], "Cidade", "Desconhecido");
            criarPontoLocal( [291, 1628], "Cidade", "Desconhecido");
            criarPontoLocal( [1311, 391], "Cidade", "Desconhecido", "Cidade alcova.jpg", true);
            criarPontoLocal( [1052, 540], "Cidade", "Desconhecido", "Alcova.png", true);
            criarPontoLocal( [1131, 688], "Cidade", "Desconhecido", "Alcova 2.png", true);
            criarPontoLocal( [1189, 1455], "Cidade", "Desconhecido", "Alcova 3.png", true);
            criarPontoLocal( [1317, 1679], "Cidade", "Desconhecido", "Cidade no mar.png", true);
            criarPontoLocal( [370, 736], "Cidade", "Desconhecido", "mais cidade no mar.png", true);
            criarPontoLocal(  [482, 1192], "Ilha dos Afogados", "Desconhecido", "lugar no mar.png", true);
            criarPontoLocal( [778, 1442], "Ilha Naval", "Marinha Imperial", "ilha naval.png", true);
            criarPontoLocal( [866, 1518], "Ilha Naval", "Marinha Imperial", "ilha naval.png", true);
            criarPontoLocal( [134, 1355], "Templo do Fim do Mundo", "Desconhecido", "Templo do fim do mundo.png", true);
          
 
        }
    }

    // --- 7. MARCADORES DO CONTINENTE ---
    function adicionarMarcadoresPrincipais() {
        const iconP = L.icon({iconUrl: 'https://unpkg.com/leaflet@1.9.4/dist/images/marker-icon.png', iconSize: [80, 80], iconAnchor: [40, 40], popupAnchor: [0, -40]});
        const iconG = L.icon({iconUrl: 'https://unpkg.com/leaflet@1.9.4/dist/images/marker-icon.png', iconSize: [120, 120], iconAnchor: [60, 60], popupAnchor: [0, -60]});

        function criarPonto(coord, nome, arg3, arg4, arg5) {
            let descricao = "";
            let arquivo = "";
            let tipo = "";
            let grande = false;

            // L√≥gica para detectar argumentos
            if (arg3 && (arg3.includes('.png') || arg3.includes('.jpg') || arg3.includes('.webp') || arg3 === null)) {
                arquivo = arg3; tipo = arg4; grande = arg5 || false;
            } else {
                descricao = arg3; arquivo = arg4; tipo = arg5;
            }

            const m = L.marker(coord, { icon: grande ? iconG : iconP, opacity: 0 }).addTo(map);
            let botoes = "";

            // --- L√ìGICA ESPECIAL PARA A CAPITAL ---
            if (nome === "Capital Imperial") {
                if (arquivo) {
                    botoes += `<button onclick="verImagemEstatica('${arquivo}')" class="btn-popup" style="margin-bottom:5px;">üì∏ Ver Cidade</button>`;
                }
                botoes += `<button onclick="menuCapital('esquadrao')" class="btn-popup" style="background:#2c3e50; margin-bottom:5px;">üõ°Ô∏è Ver Esquadr√£o</button>`;
                botoes += `<button onclick="menuCapital('procurados')" class="btn-popup" style="background:#8b0000;">‚ò†Ô∏è Procurados</button>`;
            } 
            // --- L√ìGICA PADR√ÉO ---
            else {
                if (tipo === 'mapa') {
                    botoes = `<button onclick="abrirMapaProvincia('${arquivo}')" class="btn-popup">Explorar Prov√≠ncia</button>`;
                } else if (tipo === 'imagem') {
                    botoes = `<button onclick="verImagemEstatica('${arquivo}')" class="btn-popup">Ver Foto</button>`;
                } else {
                    botoes = `<span style="color:#aaa; font-style:italic;">Sem detalhes visuais.</span>`;
                }
            }

            let conteudoPopup = `<div style="text-align:center;"><b>${nome}</b>`;
            if (descricao) {
                conteudoPopup += `<br><small style="color:#ccc;">${descricao}</small>`;
            }
            conteudoPopup += `<div style="margin-top: 12px;">${botoes}</div></div>`;

            m.bindPopup(conteudoPopup);
        }

        // PONTOS
        criarPonto([824, 2330], "Deserto","A Origem do Mundo", "Deserto.jpg", 'mapa');
        criarPonto([3850, 3580], "Hukmal'tep", "O Inverno Absoluto","Hukmal_tep.jpg", 'mapa');
        criarPonto([2902, 5464], "Blat'khyr", "O Ber√ßo da Magia", "Blat_khyr.jpg", 'mapa');
        criarPonto([1118, 4346], "Lago", "O Solo Aben√ßoado", "Lago.jpg", 'mapa');
        criarPonto([1356, 3284], "Alcova","O Lar dos Piratas", "Alcova.jpg", 'mapa');
        criarPonto([2250, 4258], "Espinha do Gigante", "As Terras Altas", "Espinha do Gigante.jpg", 'mapa', true);
        criarPonto([2142, 4378], "Espinha do Gigante","As Terras Altas", "Espinha do Gigante.jpg", 'mapa', true);
        
        // CAPITAL IMPERIAL (Agora com o menu especial)
        criarPonto([2370, 3767], "Capital Imperial", "A Casa do Imp√©rio", "Capital.png", 'imagem');

        criarPonto([1648, 4438], "Cidade Sagrada", "Cidade Santa.png", 'imagem');
        criarPonto([2862, 2890], "Torre dos S√°bios", "Torre dos Sabios.png", 'imagem');
        criarPonto([1188, 5574], "Ilha Paradis√≠aca", "ilha 2.png", 'imagem');
        criarPonto([1830, 2322], "Vilarejo", "cidade da ra√ßa l√°.png", 'imagem');
        criarPonto([2114, 3854], "Vilarejo", "vilarejo.png", 'imagem');
        criarPonto([2142, 3254], "Vilarejo", "vilarejo 2.jpg", 'imagem');
        criarPonto([1758, 4620], "Vilarejo", "vilarejo 3.jpg", 'imagem');
        criarPonto([2252, 2880], "P√¢ntano", "pantano.png", 'imagem');
        criarPonto([2138, 2890], "P√¢ntano", "pantano.png", 'imagem');
        criarPonto([2228, 3032], "P√¢ntano", "pantano.png", 'imagem');
        criarPonto([2220, 2656], "P√¢ntano", "pantano.png", 'imagem');
        criarPonto([2232, 3936], "Vilarejo", null, 'none');
        criarPonto([2300, 3400], "Vilarejo", null, 'none');
        criarPonto([1830, 4354], "Vilarejo", null, 'none');
        criarPonto([1630, 3054], "Vilarejo", null, 'none');
        criarPonto([2464, 4974], "Ilha de Blat'khyr", "Cad√™?", "Ilha.png", 'imagem');
        criarPonto([1838, 3526], "Floresta dos Sonhos", "floresta dos sonhos.png", 'imagem');
        criarPonto([1750, 3320], "Floresta dos Sonhos", "floresta dos sonhos.png", 'imagem');
        criarPonto([1536, 3634], "Floresta dos Sonhos", "floresta dos sonhos.png", 'imagem');
        criarPonto([2070, 3642], "Floresta dos Sonhos", "floresta dos sonhos.png", 'imagem');
        criarPonto([3912, 1780], "Inverno Desolado", null, 'none', true);
    }

    // Inicializa√ß√£o
    carregarMapaPrincipal();
    </script>
</body>
</html>