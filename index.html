<!DOCTYPE html>
<html lang="pt-br">
<head>
    <title>Mapa RPG Interativo 8K</title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    
    <style>
    /* --- ESTILOS GERAIS --- */
    
    /* Fundo Azul Escolhido (#4F686E) */
    body { margin: 0; background: #4F686E; overflow: hidden; font-family: sans-serif; }
    #map { height: 100vh; width: 100vw; z-index: 1; background: #4F686E; }

    /* MENU LATERAL (PRETO) */
    #menu-provincias {
        position: fixed;
        top: 20px; right: 20px;
        width: 220px;
        background: rgba(26, 26, 26, 0.95); 
        border: 2px solid #8b4513;
        border-radius: 8px;
        color: white;
        z-index: 2000;
        padding: 15px;
        box-shadow: 0 0 15px rgba(0,0,0,0.8);
        transition: 0.3s;
    }

    #menu-provincias h3 {
        text-align: center;
        margin-top: 0;
        color: #cd853f;
        border-bottom: 1px solid #555;
        padding-bottom: 10px;
        cursor: pointer;
    }

    /* Adicione isso dentro da tag <style> */
    .foto-lista { 
        width: 80px; height: 110px; 
        object-fit: cover; /* Isso impede a foto de ficar esticada/deformada */
        border: 1px solid #8b4513; 
        margin-right: 15px; 
        flex-shrink: 0; 
        background: #000;
    }

    /* Estilo para os links dentro do hist√≥rico */
    .link-historia {
        color: #ffd700; /* Amarelo Ouro */
        text-decoration: underline;
        cursor: pointer;
        font-weight: bold;
        transition: 0.2s;
    }
    .link-historia:hover {
        color: #fff; /* Fica branco ao passar o mouse */
        text-shadow: 0 0 5px #ffd700;
    }
    .texto-capitulo {
        font-size: 16px;
        line-height: 1.6;
        text-align: justify;
        white-space: pre-wrap; /* Mant√©m par√°grafos do texto */
    }

    #seta-menu { display: none; }
    #lista-botoes-provincia { display: block; }

    .botao-provincia {
        display: block; width: 100%;
        padding: 10px; margin: 5px 0;
        background: transparent; color: #ddd;
        border: 1px solid #444; border-radius: 4px;
        text-align: left; cursor: pointer;
        transition: 0.3s;
    }

    .botao-provincia:hover {
        background: #8b4513; color: white; border-color: #a0522d;
    }

    /* CONTAINER DA FOTO EST√ÅTICA */
    #provincia-container {
        display: none;
        background: #4F686E; 
        height: 100vh; width: 100vw; 
        position: fixed; top: 0; left: 0;
        z-index: 3000;
        flex-direction: column;
        align-items: center; justify-content: center;
    }

    #img-provincia {
        max-height: 85vh; max-width: 90vw;
        object-fit: contain;
        box-shadow: 0 0 50px rgba(0,0,0,1);
        border: 2px solid #333;
    }

    /* POPUPS E BOT√ïES */
    .leaflet-popup-content-wrapper { background: #2c2c2c; color: #fff; font-size: 14px; }
    .leaflet-popup-tip { background: #2c2c2c; }
    
    .btn-popup {
        background: #8b4513; color: white; border: none;
        padding: 8px 12px; border-radius: 3px;
        cursor: pointer; font-weight: bold;
    }

    /* MODAL DE DETALHES */
    #modal-info {
        position: fixed; z-index: 5000; left: 0; top: 0;
        width: 100%; height: 100%;
        background-color: rgba(0,0,0,0.8);
        display: flex; align-items: center; justify-content: center;
    }

    .modal-conteudo {
        background-color: #2c2c2c; border: 2px solid #cd853f;
        width: 60%; max-width: 800px; max-height: 80vh;
        overflow-y: auto; padding: 30px; border-radius: 10px;
        color: #ddd; font-family: serif; box-shadow: 0 0 20px #cd853f;
        position: relative;
    }
    .modal-conteudo h2 { color: #cd853f; border-bottom: 1px solid #555; padding-bottom: 10px; margin-top: 0; }
    .modal-conteudo p { line-height: 1.6; font-size: 18px; }
    .modal-conteudo strong { color: #ffdead; }
    .fechar-modal { color: #aaa; float: right; font-size: 28px; font-weight: bold; cursor: pointer; }


    /* Estilo para a lista de boatos */
    .lista-boatos {
        display: flex;
        flex-direction: column;
        gap: 10px;
    }
    .boato-item {
        background: rgba(0, 0, 0, 0.3);
        border: 1px solid #444;
        padding: 10px;
        border-radius: 5px;
        display: flex;
        align-items: flex-start;
    }
    .boato-numero {
        font-weight: bold;
        color: #cd853f;
        margin-right: 10px;
        min-width: 30px;
    }
    .boato-texto {
        font-style: italic;
        color: #aaa;
    }
    /* Estilo quando o boato √© descoberto */
    .boato-descoberto {
        border-color: #ffd700;
        background: rgba(139, 69, 19, 0.2);
    }
    .boato-descoberto .boato-texto {
        color: #ffdead;
        font-style: normal;
        font-weight: 500;
    }

    /* --- ESTILO BANCO --- */
    .tabela-banco { width: 100%; border-collapse: collapse; margin-top: 10px; font-size: 14px; }
    .tabela-banco th, .tabela-banco td { border: 1px solid #555; padding: 8px; text-align: left; color: #ddd; }
    .tabela-banco th { background-color: #3e2723; color: #ffdead; }
    .preco-banco { color: #ffd700; font-weight: bold; }
    .nota-banco { font-size: 12px; color: #aaa; margin-top: 10px; font-style: italic; }

    /* --- ESTILO DEUSES (ATUALIZADO) --- */
    .grid-deuses { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-top: 10px; }
    
    .item-deus { 
        background: rgba(0,0,0,0.4); 
        border: 1px solid #444; 
        padding: 10px; 
        border-radius: 5px; 
        text-align: center; /* Centraliza tudo */
        cursor: pointer;    /* M√£ozinha de clique */
        transition: transform 0.2s, border-color 0.2s;
    }
    .item-deus:hover {
        transform: scale(1.02);
        border-color: #ffd700;
        background: rgba(255, 215, 0, 0.1);
    }

    /* Nova classe para a imagem do deus */
    .foto-deus-thumb {
        width: 100%;
        height: 100px;
        object-fit: cover; /* Corta a imagem pra caber sem esticar */
        border-radius: 4px;
        border: 1px solid #8b4513;
        margin-bottom: 5px;
    }

    .nome-deus { color: #87ceeb; font-weight: bold; font-size: 16px; display: block; margin-bottom: 3px; }
    .desc-deus { font-size: 13px; color: #ccc; display: block; }
    .dominio-deus { font-size: 11px; color: #aaa; text-transform: uppercase; margin-top: 5px; display: block; }

    /* --- AJUSTES PARA CELULAR --- */
    @media only screen and (max-width: 600px) {
        #menu-provincias {
            width: auto !important;
            right: 10px !important; top: 10px !important;
            padding: 10px; max-width: 70vw; 
        }
        #menu-provincias h3 { margin: 0; padding-bottom: 0; border-bottom: none; font-size: 14px; }
        #seta-menu { display: inline; margin-left: 5px; }
        #lista-botoes-provincia { 
            display: none; 
            margin-top: 10px; border-top: 1px solid #555; padding-top: 5px;
        }
        .modal-conteudo { width: 90% !important; padding: 15px !important; }
        #img-provincia { max-height: 70vh !important; max-width: 95vw !important; }
        
        /* Ajuste do bot√£o de voltar para ficar no topo, abaixo do zoom */
        .leaflet-control-button-voltar {
            margin-top: 10px !important; 
        }
    }
    /* --- NOVOS ESTILOS PARA O MENU DA CAPITAL --- */
    #modal-capital {
        position: fixed; z-index: 5000; left: 0; top: 0; width: 100%; height: 100%;
        background-color: rgba(0,0,0,0.85); display: none; align-items: center; justify-content: center;
    }
    
    /* Estilo da lista de membros/procurados */
    .item-menu { 
        border-bottom: 1px solid #444; padding: 15px 0; display: flex; align-items: flex-start; 
    }
    .item-menu:last-child { border-bottom: none; }
    
    .foto-placeholder { 
        width: 80px; height: 110px; background: #3d3d3d; border: 1px solid #8b4513; 
        margin-right: 15px; flex-shrink: 0; display: flex; 
        align-items: center; justify-content: center; font-size: 10px; color: #777; 
    }
    
    .texto-item h4 { margin: 0 0 5px 0; color: #ffdead; font-size: 18px; }
    .texto-item p { font-size: 14px; margin: 0; color: #ccc; }
    .recompensa { color: #ffd700; font-weight: bold; display: block; margin-bottom: 5px; }
    .classe-char { color: #cd853f; font-weight: bold; font-size: 12px; text-transform: uppercase; display: block; margin-bottom: 5px; }
    </style>
</head>
<body>
    <div id="map-container">
        <div id="map"></div>
    </div>

    <div id="modal-info" style="display: none;">
        <div class="modal-conteudo">
            <span class="fechar-modal" onclick="fecharModalInfo()">&times;</span>
            <h2 id="titulo-provincia">T√≠tulo</h2>
            <div id="texto-provincia"></div>
        </div>
    </div>
    <div id="modal-capital">
        <div class="modal-conteudo">
            <span class="fechar-modal" onclick="fecharModais()">&times;</span>
            <h2 id="titulo-menu-capital" style="color: #cd853f; border-bottom: 1px solid #555;">Capital</h2>
            <div id="conteudo-menu-capital">
                </div>
        </div>
    </div>

<div id="menu-provincias">
        <h3 onclick="alternarMenuMobile()">Menu Principal <span id="seta-menu">‚ñº</span></h3>
        <div id="lista-botoes-provincia">
            <button class="botao-provincia" onclick="abrirMapaProvincia('Hukmal_tep.jpg')">Hukmal'tep</button>
            <button class="botao-provincia" onclick="abrirMapaProvincia('Blat_khyr.jpg')">Blat'khyr</button>
            <button class="botao-provincia" onclick="abrirMapaProvincia('Deserto.jpg')">Deserto</button>
            <button class="botao-provincia" onclick="abrirMapaProvincia('Lago.jpg')">Lago</button>
            <button class="botao-provincia" onclick="abrirMapaProvincia('Alcova.jpg')">Alcova</button>
            <button class="botao-provincia" onclick="abrirMapaProvincia('Espinha do Gigante.jpg')">Espinha do Gigante</button>
            
            <hr style="border: 0; border-top: 1px solid #555; margin: 10px 0;">
            <div style="color: #cd853f; font-size: 12px; margin-bottom: 5px; text-align: center;">COSMOLOGIA</div>
            <button class="botao-provincia" onclick="abrirModalSenha('portal', 'bloqueado.jpg', 'imagem')" style="color: #aeb6bf;">üåå Outros Planos</button>

            <hr style="border: 0; border-top: 1px solid #555; margin: 10px 0;">
            <button id="btn-coords-menu" class="botao-provincia" onclick="alternarCoordenadas()" style="color: #aaa;">üìç Coords: OFF</button>
        </div>
    </div>

    <div id="provincia-container">
        <img id="img-provincia" src="">
    </div>

<div id="modal-senha" style="display: none; position: fixed; z-index: 6000; left: 0; top: 0; width: 100%; height: 100%; background-color: rgba(0,0,0,0.85); align-items: center; justify-content: center;">
        <div class="modal-conteudo" style="width: 400px; text-align: center;">
            <h3 style="color: #cd853f;">üîí √Årea Bloqueada</h3>
            <p>Qual a palavra de passe?</p>
            
            <input type="text" id="input-senha-rpg" placeholder="Digite a senha..." 
                   style="width: 80%; padding: 10px; margin-bottom: 20px; background: #222; border: 1px solid #8b4513; color: white; font-size: 16px; text-align: center;">
            
            <br>
            <button class="btn-popup" onclick="verificarSenha()" style="background: #2E8B57; font-size: 16px; margin-right: 10px;">üîì Tentar</button>
            <button class="btn-popup" onclick="fecharModalSenha()" style="background: #8b0000; font-size: 16px;">‚ùå Cancelar</button>
            
            <p id="msg-erro-senha" style="color: #ff4444; display: none; font-size: 14px; margin-top: 10px;">Senha incorreta. A barreira permanece.</p>
        </div>
    </div>

    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

    <script>
// --- 1. CONFIGURA√á√ïES T√âCNICAS ---
    const configContinental = { arquivo: 'Mapa teste.png', largura: 7680, altura: 4320, minZoom: -2.0, maxZoom: 3 };
    const configProvincia = { largura: 2048, altura: 1536, minZoom: -1.0, maxZoom: 2 };
    
    // --- VARI√ÅVEIS GLOBAIS ---
    let map; 
    let mapaAtualAtivo = 'continente';
    let modoCoordenadas = false; // Vari√°vel global importante

    // --- FUN√á√ïES DE NAVEGA√á√ÉO E SISTEMA ---

// --- 2. INICIALIZA√á√ÉO DO MAPA (COM BOT√ÉO PERSISTENTE) ---
    function inicializarMapa(arquivo, largura, altura, minZoom, maxZoom) {
        if (map) { map.remove(); } 

        const limitesImagem = [[0, 0], [altura, largura]];
        const padding = 1500; 
        const limitesNavegacao = [[-padding, -padding], [altura + padding, largura + padding]];
        
        map = L.map('map', {
            crs: L.CRS.Simple,
            minZoom: minZoom,
            maxZoom: maxZoom,
            maxBounds: limitesNavegacao, 
            maxBoundsViscosity: 0.5,     
            tap: false,
            zoomControl: false // Opcional: Se quiser mover o zoom, avise
        });

        // Adiciona o Zoom num lugar padr√£o (j√° que removemos acima para testar, se sumir o zoom apague a linha zoomControl: false)
        L.control.zoom({ position: 'topleft' }).addTo(map);

        L.imageOverlay(arquivo, limitesImagem).addTo(map);
        map.fitBounds(limitesImagem);
        
        // --- 1. L√ìGICA DO CLIQUE ---
        map.on('click', function(e) {
            if (modoCoordenadas) {
                const y = e.latlng.lat.toFixed(0);
                const x = e.latlng.lng.toFixed(0);
                L.popup().setLatLng(e.latlng).setContent(`Coordenadas: [${y}, ${x}]`).openOn(map);
                console.log(`[${y}, ${x}]`); 
            }
        });

        // --- 2. BOT√ÉO FLUTUANTE NO MAPA ---
        const CoordsControl = L.Control.extend({
            options: { position: 'bottomright' }, // Canto inferior direito
            onAdd: function() {
                const btn = L.DomUtil.create('button', '');
                btn.id = 'btn-coords-mapa'; // ID para a gente achar ele depois
                btn.style.cssText = "padding:8px 12px; border-radius:5px; cursor:pointer; font-weight:bold; font-size:12px; margin-right: 10px; margin-bottom: 10px;";
                
                // Define a cor inicial baseada no estado atual
                atualizarVisualBotao(btn);

                btn.onclick = function(e) {
                    L.DomEvent.stopPropagation(e); // N√£o clica no mapa
                    alternarCoordenadas();
                };
                return btn;
            }
        });
        map.addControl(new CoordsControl());
    }

    // 2. Alterna menu no celular
    function alternarMenuMobile() {
        if (window.innerWidth > 600) return;
        const lista = document.getElementById('lista-botoes-provincia');
        const seta = document.getElementById('seta-menu');
        const estiloAtual = window.getComputedStyle(lista).display;
        if (estiloAtual === 'none') {
            lista.style.display = 'block';
            seta.innerHTML = '‚ñ≤';
        } else {
            lista.style.display = 'none';
            seta.innerHTML = '‚ñº';
        }
    }

    // 3. Carrega o mapa principal (Continente)
    function carregarMapaPrincipal() {
        mapaAtualAtivo = 'continente';
        document.getElementById('map-container').style.display = 'block';
        document.getElementById('provincia-container').style.display = 'none';
        document.getElementById('menu-provincias').style.display = 'block';
        
        if (window.innerWidth <= 600) {
            document.getElementById('lista-botoes-provincia').style.display = 'none';
            document.getElementById('seta-menu').innerHTML = '‚ñº';
        } else {
            document.getElementById('lista-botoes-provincia').style.display = 'block';
        }

        inicializarMapa(configContinental.arquivo, configContinental.largura, configContinental.altura, configContinental.minZoom, configContinental.maxZoom);
        adicionarMarcadoresPrincipais();
    } // <--- AQUI FECHA A FUN√á√ÉO carregarMapaPrincipal (Isso estava faltando no seu c√≥digo anterior)

    // --- FUN√á√ïES DOS BOT√ïES EXTRAS (Agora fora de qualquer outra fun√ß√£o) ---

// --- VARI√ÅVEIS PARA O SISTEMA DE SENHA (CORRIGIDO) ---
    let senhaCorretaAtual = "";
    let destinoAposSenha = ""; // Substitui o antigo 'mapaDestinoAtual'
    let tipoAcaoSenha = "mapa"; // Vari√°vel nova para controlar se abre mapa ou foto

    // 1. Abre a janela de senha
    function abrirModalSenha(senha, destino, tipo = 'mapa') {
        senhaCorretaAtual = senha;
        destinoAposSenha = destino; // Salva o destino na vari√°vel certa
        tipoAcaoSenha = tipo;       // Salva o tipo de a√ß√£o
        
        // Limpa o campo e esconde erro anterior
        document.getElementById('input-senha-rpg').value = "";
        document.getElementById('msg-erro-senha').style.display = 'none';
        
        // Mostra o modal
        document.getElementById('modal-senha').style.display = 'flex';
        
        // Foca no input para digitar direto
        document.getElementById('input-senha-rpg').focus();
    }

    // 2. Verifica a senha
    function verificarSenha() {
        const input = document.getElementById('input-senha-rpg');
        const msgArea = document.getElementById('msg-erro-senha');
        
        // Verifica a senha (ignora mai√∫sculas/min√∫sculas)
        if (input.value && input.value.toLowerCase() === senhaCorretaAtual.toLowerCase()) {
            
            // SUCESSO
            msgArea.style.display = 'block';
            msgArea.style.color = '#2ecc71'; 
            msgArea.innerHTML = "‚ú® Acesso concedido!";
            
            input.disabled = true;

            // Espera 1.5s e executa a a√ß√£o
            setTimeout(() => {
                document.getElementById('modal-senha').style.display = 'none';
                
                // Reseta visual
                input.value = "";
                input.disabled = false;
                msgArea.style.display = 'none';
                msgArea.style.color = '#ff4444'; 
                
                // DECIDE A A√á√ÉO (MAPA OU IMAGEM) USANDO A VARI√ÅVEL CERTA
                if (tipoAcaoSenha === 'imagem') {
                    verImagemEstatica(destinoAposSenha);
                } else {
                    abrirMapaProvincia(destinoAposSenha);
                }

            }, 1500);

        } else {
            // ERRO
            msgArea.style.display = 'block';
            msgArea.style.color = '#ff4444';
            msgArea.innerHTML = "Senha incorreta. Por favor AGUARDE descobrirem essa √°rea.";
            
            input.style.borderColor = "red";
            setTimeout(() => input.style.borderColor = "#8b4513", 500);
            input.select(); 
        }
    }

    // 3. Fecha o modal
    function fecharModalSenha() {
        document.getElementById('modal-senha').style.display = 'none';
    }

    // 4. Atalho Enter
    const inputSenha = document.getElementById('input-senha-rpg');
    if (inputSenha) {
        inputSenha.addEventListener("keypress", function(event) {
            if (event.key === "Enter") {
                verificarSenha();
            }
        });
    }
    // 1. Abre a janela bonita (Agora aceita o tipo de a√ß√£o)
    function abrirModalSenha(senha, destino, tipo = 'mapa') {
        senhaCorretaAtual = senha;
        destinoAposSenha = destino;
        tipoAcaoSenha = tipo;
        
        // Limpa o campo e esconde erro anterior
        document.getElementById('input-senha-rpg').value = "";
        document.getElementById('msg-erro-senha').style.display = 'none';
        
        // Mostra o modal
        document.getElementById('modal-senha').style.display = 'flex';
        
        // Foca no input para digitar direto
        document.getElementById('input-senha-rpg').focus();
    }

    // --- FUN√á√ÉO DE VERIFICA√á√ÉO (ATUALIZADA) ---
    function verificarSenha() {
        const input = document.getElementById('input-senha-rpg');
        const msgArea = document.getElementById('msg-erro-senha');
        
        // Verifica a senha (ignora mai√∫sculas/min√∫sculas)
        if (input.value && input.value.toLowerCase() === senhaCorretaAtual.toLowerCase()) {
            
            // 1. Mostra mensagem de SUCESSO
            msgArea.style.display = 'block';
            msgArea.style.color = '#2ecc71'; 
            msgArea.innerHTML = "‚ú® Acesso concedido!"; // Mensagem gen√©rica
            
            input.disabled = true;

            // 3. Espera 1.5 segundos e executa a a√ß√£o correta
            setTimeout(() => {
                document.getElementById('modal-senha').style.display = 'none';
                
                input.value = "";
                input.disabled = false;
                msgArea.style.display = 'none';
                msgArea.style.color = '#ff4444'; 
                
                // L√ìGICA NOVA: Decide se abre mapa ou imagem
                if (tipoAcaoSenha === 'imagem') {
                    verImagemEstatica(destinoAposSenha);
                } else {
                    abrirMapaProvincia(destinoAposSenha);
                }

            }, 1500);

        } else {
            // Erro
            msgArea.style.display = 'block';
            msgArea.style.color = '#ff4444';
            msgArea.innerHTML = "Senha incorreta. Por favor AGUARDE voc√™s descobrirem a senha.";
            
            input.style.borderColor = "red";
            setTimeout(() => input.style.borderColor = "#8b4513", 500);
            input.select(); 
        }
    }

    // 3. Fecha sem fazer nada
    function fecharModalSenha() {
        document.getElementById('modal-senha').style.display = 'none';
    }

    // 4. (Opcional) Permitir apertar ENTER para enviar
    document.getElementById('input-senha-rpg').addEventListener("keypress", function(event) {
        if (event.key === "Enter") {
            verificarSenha();
        }
    });
function alternarCoordenadas() {
        modoCoordenadas = !modoCoordenadas; // Inverte o valor
        
        // Atualiza o bot√£o do Menu Lateral (se existir)
        const btnMenu = document.getElementById('btn-coords-menu');
        atualizarVisualBotao(btnMenu);

        // Atualiza o bot√£o Flutuante do Mapa (se existir)
        const btnMapa = document.getElementById('btn-coords-mapa');
        atualizarVisualBotao(btnMapa);
    }

    // Fun√ß√£o auxiliar para mudar a cor dos bot√µes
    function atualizarVisualBotao(btn) {
        if (!btn) return;
        
        if (modoCoordenadas) {
            btn.innerHTML = "üìç Coords: ON";
            btn.style.background = "#27ae60"; 
            btn.style.color = "white";
            btn.style.border = "1px solid #2ecc71";
        } else {
            btn.innerHTML = "üìç Coords: OFF";
            btn.style.background = "rgba(0,0,0,0.7)"; 
            btn.style.color = "#aaa";
            btn.style.border = "1px solid #444";
        }
    }

    // ... (O resto do seu c√≥digo: dadosProvincias, dadosCapital, etc. continua igual abaixo)

    // --- 5. BANCO DE DADOS (TEXTOS COMPLETOS RESTAURADOS) ---
    const dadosProvincias = {
        'Hukmal_tep.jpg': {
            titulo: "Hukmal'tep - O Inverno Absoluto",
            descricao: `
                <p><strong>üìú Panorama:</strong> Uma vastid√£o dominada por picos colossais e frio implac√°vel. O vento uiva incessantemente entre os vales profundos, moldando uma paisagem onde apenas os mais resilientes prosperam sob o manto de neve eterna.</p>
                <p><strong>üëë Governan√ßa:</strong> O poder √© partilhado pelo <em>Conselho das Tr√™s Tribos</em> (Felistas, Malistas e Garra do Inverno). N√£o existe um soberano √∫nico, mas sim uma tr√©gua armada e tensa entre os cl√£s.</p>
                <p><strong>üßë‚Äçü§ù‚Äçüßë Habitantes:</strong> Predominantemente composta por Humanos adaptados ao clima severo, An√µes das montanhas e Mesti√ßos que buscam ref√∫gio na isola√ß√£o.</p>
                <p><strong>‚öîÔ∏è Tradi√ß√µes:</strong> Uma cultura que exalta a for√ßa bruta e o instinto de sobreviv√™ncia. A magia √© encarada com profundo ceticismo e desconfian√ßa; estudiosos e acad√™micos s√£o raros e raramente bem-vindos.</p>
                <p><strong>üíé Subsist√™ncia:</strong> A economia gira em torno do com√©rcio de peles ex√≥ticas e subprodutos obtidos da ca√ßa de feras colossais que habitam a regi√£o.</p>
            `
        },
        'Blat_khyr.jpg': {
            titulo: "Blat'khyr - O Ber√ßo da Magia",
            descricao: `
                <p><strong>üìú Panorama:</strong> Um reino onde a realidade √© moldada pelo fluxo m√≠stico. A densidade de mana nesta prov√≠ncia √© t√£o alta que a pr√≥pria fauna e flora sofreram muta√ß√µes m√°gicas, criando cen√°rios de beleza surreal e perigo arcano.</p>
                <p><strong>üëë Governan√ßa:</strong> Embora exista uma linhagem real √©lfica cerimonial, a gest√£o administrativa e pol√≠tica reside nas m√£os do <em>Conselho √âlfico</em>, composto pelos mais experientes anci√£os da ra√ßa.</p>
                <p><strong>üßë‚Äçü§ù‚Äçüßë Habitantes:</strong> Uma popula√ß√£o majoritariamente de Elfos e Humanos com afinidade m√°gica.</p>
                <p><strong>‚öîÔ∏è Tradi√ß√µes:</strong> A sociedade valoriza o intelecto, a eleg√¢ncia est√©tica e a maestria arcana. Existe um forte sentimento de preserva√ß√£o cultural entre os Elfos, que muitas vezes evitam o contato pr√≥ximo com outras ra√ßas para preservar o seu "potencial m√≠stico".</p>
                <p><strong>üíé Subsist√™ncia:</strong> O epicentro do mercado arcano, focado na cria√ß√£o, encantamento e exporta√ß√£o de itens m√°gicos de alt√≠ssima qualidade.</p>
            `
        },
        'Deserto.jpg': {
            titulo: "O Deserto - A Origem do Mundo",
            descricao: `
                <p><strong>üìú Sociedade de Castas:</strong> Uma teocracia r√≠gida baseada no controle da √°gua. No topo est√£o os <strong>Zha-Ruk</strong> (Senhores da Nascente), seguidos pelos <strong>Atarim</strong> (Buscadores de Rel√≠quias) e os ricos <strong>Samum</strong> (Mercadores). A base √© formada pelos <strong>Ghovar</strong> (Trabalhadores) e, √† margem, os temidos <strong>Khali</strong> (Os "Secos" ou intoc√°veis).</p>
                <p><strong>üëë Governan√ßa:</strong> Cidades-estado controladas pelos Zha-Ruk, onde a lei √© ditada pela preserva√ß√£o h√≠drica. Desperdi√ßar √°gua √© punido com a morte ou ex√≠lio.</p>
                <p><strong>üßë‚Äçü§ù‚Äçüßë Ra√ßas Principais:</strong> Humanos, Meio-dem√¥nios, an√µes, mesti√ßos e seres adaptados ao calor extremo.</p>
                <p><strong>‚öîÔ∏è Tradi√ß√µes:</strong> Forte tradi√ß√£o oral e leis de hospitalidade r√≠gidas. As ru√≠nas antigas s√£o consideradas sagradas e perigosas, acess√≠veis apenas aos autorizados.</p>
                <p><strong>üíé Economia:</strong> Extra√ß√£o de especiarias raras, min√©rios e venda de rel√≠quias da "Primeira Era" encontradas nas escava√ß√µes.</p>
            `
        },
        'Lago.jpg': {
            titulo: "O Lago - O Solo Aben√ßoado",
            descricao: `
                <p><strong>üìú Panorama:</strong> Uma regi√£o de serenidade contemplativa, onde a honra se reflete nas √°guas cristalinas do lago sagrado. A arquitetura √© integrada √† natureza, utilizando madeira e pedra em designs orientais cl√°ssicos.</p>
                <p><strong>üëë Governan√ßa:</strong> Uma oligarquia de disnastias que comandam as terras e que governam sob um r√≠gido c√≥digo de honra e lealdade ao trono imperial.</p>
                <p><strong>üßë‚Äçü§ù‚Äçüßë Habitantes:</strong> Humanos e Mesti√ßos.</p>
                <p><strong>‚öîÔ∏è Tradi√ß√µes:</strong> Os costumes s√£o profundamente orientais, valorizando o respeito aos ancestrais, a cerim√¥nia do ch√° e a disciplina das artes marciais e caligrafia. A harmonia e o equil√≠brio espiritual s√£o os pilares da sociedade.</p>
                <p><strong>üíé Subsist√™ncia:</strong> O celeiro do imp√©rio; produz gr√£os finos, seda de alta qualidade e pescados raros encontrados apenas nas profundezas do lago.</p>
            `
        },
        'Alcova.jpg': {
            titulo: "Alcova - O Lar dos Piratas",
            descricao: `
                <p><strong>üìú Descri√ß√£o:</strong> Um arquip√©lago repleto de ba√≠as escondidas, cavernas marinhas e rotas de navega√ß√£o perigosas.</p>
                <p><strong>üëë Governo:</strong> Uma "Confedera√ß√£o Livre" onde a lei √© ditada por quem possui o navio mais r√°pido ou os canh√µes mais fortes.</p>
                <p><strong>üßë‚Äçü§ù‚Äçüßë Ra√ßas Principais:</strong> Uma mistura ca√≥tica de todas as ra√ßas, principalmente aquelas fugindo da lei imperial.</p>
                <p><strong>‚öîÔ∏è Cultura:</strong> Liberdade individual extrema e um c√≥digo de honra duvidoso entre capit√£es.</p>
                <p><strong>üíé Economia:</strong> Pirataria, mercado negro e transporte de mercadorias ex√≥ticas "n√£o taxadas".</p>
            `
        },
        'Espinha do Gigante.jpg': {
            titulo: "Regi√£o Desconhecida",
            descricao: "<p>N√£o h√° registros detalhados sobre esta √°rea nos arquivos imperiais.</p>"
        },

    'Mar.jpg': {
        titulo: "O Mar Profundo",
        descricao: "<p><strong>üåä Descri√ß√£o:</strong> Uma vastid√£o azul e perigosa, acess√≠vel apenas para aqueles que conhecem os segredos das mar√©s.</p>"
    },
    
    // ... outros mapas
        'default': { 
            titulo: "Regi√£o Desconhecida", 
            descricao: "<p>N√£o h√° registros detalhados sobre esta √°rea nos arquivos imperiais.</p>" 
            
        }
    };

// --- DADOS DA CAPITAL (COM FOTOS) ---
// 1. Cria 100 boatos vazios automaticamente
    const listaBoatos = Array.from({ length: 100 }, (_, i) => ({
        id: i + 1,
        texto: "Boato ainda n√£o ouvido...",
        descoberto: false
    }));

    // 2. Define o Boato 100 (O √∫nico conhecido agora)
    // Nota: Como array come√ßa no 0, o boato 100 fica na posi√ß√£o 99
    listaBoatos[99] = {
        id: 100,
        texto: "Dizem que existe um 101¬∫ boato que revela o segredo para se tornar um deus, mas ningu√©m nunca o ouviu. E dizem que tudo o que voc√™ ouviu at√© agora pode ser uma mentira inventada para te manter longe da verdade.",
        descoberto: true
    };

    // --- DADOS GERAIS (BANCO E DEUSES) ---
    const dadosGerais = {
        banco: [
            { nome: "Pacote Econ√¥mico", custo: "2 Golds", desc: "Poder enterrar em um canto e o gerente finge que n√£o viu." },
            { nome: "Pacote Iniciante", custo: "5 Golds", desc: "Guarda at√© 50 golds e 1 item." },
            { nome: "Pacote Intermedi√°rio", custo: "15 Golds", desc: "Guarda 150g, 1 armadura, 1 arma, 3 itens. (Acesso transporte imperial)" },
            { nome: "Pacote Avan√ßado", custo: "35 Golds", desc: "Seguro de vida, 300g, 2 armaduras, 4 armas, 6 itens, 1 criatura. (Acesso transporte)" },
            { nome: "Pacote Arranjado", custo: "A Definir", desc: "Negociado diretamente com o contratante." },
            { nome: "Pacote VIP", custo: "Exclusivo", desc: "Guarda de objeto/criatura com avalia√ß√£o personalizada." }
        ],
        investimentos: [
            { nome: "Tesouro Imperial", risco: "Baixo Risco", min: "5g" },
            { nome: "A√ß√µes do Imp√©rio", risco: "Alto Risco", min: "5g" }
        ],
// Dentro de const dadosGerais = { ...
    
deuses: [
        { nome: "Pelor", titulo: "Sol, Luz e Fogo", raca: "Anjos", foto: "Pelor.png" },
        { nome: "Aqua", titulo: "√Ågua e Serenidade", raca: "Halflings", foto: "Aqua.png" },
        { nome: "Celeste", titulo: "Espa√ßo", raca: "Estrelas", foto: "Celeste.png" },
        { nome: "Luna", titulo: "Lua e Trevas", raca: "Dem√¥nios", foto: "Luna.png" },
        { nome: "Laphiaferd", titulo: "Magia", raca: "Esp√≠ritos", foto: "Laphiaferd.png" },
        { nome: "H√∫ngaro", titulo: "Tempo", raca: "Humanos", foto: "H√∫ngaro.png" },
        { nome: "Terraria", titulo: "Terra e Lealdade", raca: "An√µes", foto: "Terraria.png" },
        { nome: "Astronof", titulo: "Ar e Conhecimento", raca: "Machinas", foto: "Astronof.png" },
        { nome: "Golias (PVP)", titulo: "Guerra", raca: "Gigantes", foto: "Golias (PvP).png" },
        { nome: "Dentos", titulo: "Gan√¢ncia", raca: "Orcs e Trolls", foto: "Dentos.png" },
        { nome: "Lusit√¢nia", titulo: "Plantas", raca: "Elfos", foto: "Lusit√¢nia.png" },
        { nome: "Ruegra", titulo: "Animais", raca: "Mesti√ßos", foto: "Ruegra.png" }
    ]
};

    const dadosCapital = {
        esquadrao: [
            // Coloque o nome EXATO do arquivo da imagem que est√° na pasta
            { 
                nome: "Lythael Serind√´", 
                classe: "Curandeira", 
                raca: "Elfa alta",
                foto: "Lythael.png",  // <--- AQUI VAI O ARQUIVO DA FOTO
                desc: "Uma guardi√£ serena e observadora, cuja gentileza externa esconde uma for√ßa inabal√°vel dedicada a proteger e valorizar toda forma de vida.om uma espada longa." 
            },
            { 
                nome: "Valkia Huniman", 
                raca: "Meio Anja",
                classe: "Guerreira", 
                foto: "Valkia.png",     // <--- AQUI VAI O ARQUIVO DA FOTO
                desc: "Embora aparente seriedade inicial, logo revela uma natureza vibrante e impetuosa, movida pelo desejo de provar sua evolu√ß√£o enquanto exalta constantemente os nomes de Ryuiki e Daruin." 
            },
                        { 
                nome: "Greta Thunder", 
                raca: "Elfa da Floresta",
                classe: "Maga", 
                foto: "Greta.jpg",     // <--- AQUI VAI O ARQUIVO DA FOTO
                desc: "Uma guardi√£ solit√°ria de Desterroth que nutre profundo desprezo pela humanidade e outras ra√ßas, confiando apenas na justi√ßa da natureza e em seus cactos; agora, ela √© for√ßada a agir contra uma corrup√ß√£o obscura que amea√ßa a floresta que jurou proteger." 
            },
                        { 
                nome: "Balon Blacktide", 
                raca: "Meio Dem√¥nio",
                classe: "Ca√ßador", 
                foto: "Balon.jpg",     // <--- AQUI VAI O ARQUIVO DA FOTO
                desc: "Das li√ß√µes da nobreza aos naufr√°gios da pirataria, este meio-dem√¥nio de poucas palavras carrega no sobrenome a marca de sua sobreviv√™ncia e, na alma, o conflito eterno entre o sangue amaldi√ßoado e a luz que busca gui√°-lo." 
            },
                        { 
                nome: "Thorga Punho de Ferro", 
                raca: "An√£o",
                classe: "Guerreiro", 
                foto: "Thorga.jpg",     // <--- AQUI VAI O ARQUIVO DA FOTO
                desc: "Exilado injustamente das forjas ancestrais, Thorgar √© um mercen√°rio impetuoso que rejeita a autoridade de reis e deuses, lutando pela pura emo√ß√£o da batalha e para provar que sua for√ßa basta por si s√≥." 
            },
                        { 
                nome: "Li√©sty", 
                raca: "Elfa Negra",
                classe: "Maga", 
                foto: "Li√©sty.jpg",     // <--- AQUI VAI O ARQUIVO DA FOTO
                desc: "Sobrevivente solit√°ria de uma destrui√ß√£o brutal, esta elfa negra trocou a companhia dos vivos pelo sil√™ncio de sua cabana na floresta, onde sua natureza sombria e suas artes arcanas servem como barreira contra um mundo que ela aprendeu a desprezar." 
            }
        ],
        procurados: [
            { 
                nome: "Kalamar", 
                recompensa: "1.800 Moedas de Ouro", 
                foto: "Kalamar.png",   // <--- AQUI VAI O ARQUIVO DA FOTO
                desc: "Vivo ou morto. Lenda dos mares que trocou a gl√≥ria da aventura pelo submundo. Comanda uma frota colossal que espalha terror pelos oceanos, traficando de rel√≠quias a vidas sem distin√ß√£o." 
            },
            { 
                nome: "Bruiser", 
                recompensa: "1.200 Moedas de Ouro", 
                foto: "Bruiser.png",        // Se n√£o tiver foto, coloque null ou apague a linha foto
                desc: "Vivo ou morto. Um mago renegado cuja sede de conhecimento ultrapassou a moralidade. Procurado por conduzir experimentos grotescos e ilegais em seres vivos, distorcendo a natureza em busca de poder." 
            },
            { 
                nome: "Leimo", 
                recompensa: "1.500 Moedas de Ouro", 
                foto: "Leimo.png",           // Se n√£o tiver foto, coloque null ou apague a linha foto
                desc: "Morto. Ex-membro da Torre dos S√°bios. Sua genialidade tornou-se arrog√¢ncia; ele se rebelou por acreditar ser uma divindade entre mortais, usando segredos arcanos para cometer crimes contra o Imp√©rio." 
            },
            { 
                nome: "O Palha√ßo", 
                recompensa: "10.000 Moedas de Ouro", 
                foto: "Palha√ßo.png",          // Se n√£o tiver foto, coloque null ou apague a linha foto
                desc: "Vivo. Um agente do caos que semeia disc√≥rdia por puro entretenimento. Suspeito de conspirar com for√ßas das trevas, ele manipula reinos para incitar guerras, rindo enquanto o mundo queima." 
            },
            { 
                nome: "Fanastia", 
                recompensa: "700 Moedas de Ouro", 
                foto: "Fanastia.png",           // Se n√£o tiver foto, coloque null ou apague a linha foto
                desc: "Vivo ou morto. Uma vampira ancestral com um rastro de sangue que atravessa s√©culos. Respons√°vel pelo massacre de mais de mil almas, ela v√™ a humanidade apenas como alimento para saciar sua sede eterna." 
            },
            { 
                nome: "Mari, a Psicopata", 
                recompensa: "500 Moedas de Ouro", 
                foto: "Mari.png",           // Se n√£o tiver foto, coloque null ou apague a linha foto
                desc: "Morto. Uma for√ßa de destrui√ß√£o imprevis√≠vel e sem remorso. N√£o possui agenda pol√≠tica ou m√°gica; mata por impulso e loucura, deixando um rastro de terror por onde passa." 
            },
            { 
                nome: "Leoncio", 
                recompensa: "2.000 Moedas", 
                foto: "Leoncio.png",           // Se n√£o tiver foto, coloque null ou apague a linha foto
                desc: "Morto. Antigo instrutor de elite do Imp√©rio, agora seu maior traidor. Conhece todas as t√°ticas militares de seus ex-aliados, usando esse conhecimento para desestabilizar a na√ß√£o que jurou defender." 
            },
            { 
                nome: "Drai", 
                recompensa: "2.000 Moedas", 
                foto: "Drai.png",           // Se n√£o tiver foto, coloque null ou apague a linha foto
                desc: "Morto. Feiticeira xen√≥foba obcecada pelos esp√≠ritos da floresta. V√™ outras ra√ßas como pragas e executa assassinatos em massa para 'purificar' a natureza, servindo a uma vis√£o distorcida do equil√≠brio." 
            }
        ],
        
        // --- NOVO: HIST√ìRICO ---
        historico: [
            {
                titulo: "Cap√≠tulo 0: O Chamado",
                texto: `
                A jornada come√ßou com um sonho misterioso, onde o <span class="link-historia" onclick="verImagemHistoria('Serafim.png', 0)">Serafim da Ordem</span> revelou o retorno de uma for√ßa de destrui√ß√£o. Em troca de salvarem o mundo, ele prometeu realizar seus desejos e os guiou at√© a <span class="link-historia" onclick="verImagemHistoria('Capital.png', 0)">Capital Imperial</span>.
                
                L√°, o grupo se alistou no ex√©rcito com a ajuda do amig√°vel <span class="link-historia" onclick="verImagemHistoria('Will.png', 0)">Will</span> e adotou o nome "Os Pandem√¥nios". Para provar seu valor, enfrentaram os testes rigorosos da Comandante <span class="link-historia" onclick="verImagemHistoria('Valentina.png', 0)">Valentina</span>, que inclu√≠ram enigmas e uma batalha brutal contra um <span class="link-historia" onclick="verImagemHistoria('Gorila.png', 0)">Gorila</span> feroz.
                
                Na primeira miss√£o, sob a supervis√£o da arrogante Mestra <span class="link-historia" onclick="verImagemHistoria('Carla.png', 0)">Carla</span>, foram capturados pelo infame Capit√£o <span class="link-historia" onclick="verImagemHistoria('Kalamar.png', 0)">Kalamar</span>. Amea√ßados, tiveram que explorar uma masmorra antiga repleta de enigmas e tecnologia esquecida.
                
                O cl√≠max foi o confronto contra um <span class="link-historia" onclick="verImagemHistoria('Kraken.png', 0)">Kraken</span> colossal. Ap√≥s derrotarem a besta e recuperarem uma b√∫ssola m√°gica, a ilha foi destru√≠da, e o grupo escapou por pouco gra√ßas √† interven√ß√£o her√≥ica de Will.`
            },
            {
                titulo: "Cap√≠tulo 1: Desconhecido",
                texto: `Aventura em progresso...`
            },
            {
                titulo: "Cap√≠tulo 2: Desconhecido",
                texto: `Aventura em progresso...`
            },
            {
                titulo: "Cap√≠tulo 3: Desconhecido",
                texto: `Aventura em progresso...`
            },
            {
                titulo: "Cap√≠tulo 4: Desconhecido",
                texto: `Aventura em progresso...`
            }
        ],
        boatos: listaBoatos
    };

// --- FUN√á√ÉO MENU CAPITAL (ATUALIZADA COM BANCO) ---
    function menuCapital(tipo) {
        const modal = document.getElementById('modal-capital');
        const container = document.getElementById('conteudo-menu-capital');
        const titulo = document.getElementById('titulo-menu-capital');
        modal.style.display = 'flex';
        container.innerHTML = "";

        // --- ABA BANCO (NOVO) ---
        if (tipo === 'banco') {
            titulo.innerText = "üè¶ Banco Imperial";
            let html = `<h4 style="color:#ffdead; margin-top:0;">Pacotes de Servi√ßos</h4>`;
            
            html += `<table class="tabela-banco"><tr><th>Pacote</th><th>Custo</th><th>Benef√≠cios</th></tr>`;
            dadosGerais.banco.forEach(item => {
                html += `<tr><td>${item.nome}</td><td class="preco-banco">${item.custo}</td><td>${item.desc}</td></tr>`;
            });
            html += `</table>`;

            html += `<h4 style="color:#ffdead; margin-top:20px;">Investimentos</h4>`;
            html += `<ul style="color:#ccc; padding-left:20px;">`;
            dadosGerais.investimentos.forEach(inv => {
                html += `<li><strong>${inv.nome}:</strong> ${inv.risco} (M√≠nimo ${inv.min})</li>`;
            });
            html += `</ul>`;

            html += `<div class="nota-banco">
                * Garantia total sobre bens guardados.<br>
                * N√£o existe upgrade de pacote (pre√ßo integral na troca).
            </div>`;
            
            container.innerHTML = html;
            return;
        }

        // --- ABA BOATOS ---
        if (tipo === 'boatos') {
            titulo.innerText = "üó£Ô∏è Boatos da Capital (1/100)";
            let html = `<div class="lista-boatos">`;
            dadosCapital.boatos.forEach(boato => {
                const classeExtra = boato.descoberto ? 'boato-descoberto' : '';
                const textoFinal = boato.descoberto ? boato.texto : "??????????????????";
                html += `<div class="boato-item ${classeExtra}"><span class="boato-numero">#${boato.id}</span><span class="boato-texto">"${textoFinal}"</span></div>`;
            });
            html += `</div>`;
            container.innerHTML = html;
            return;
        }

        // --- ABA HIST√ìRICO ---
        if (tipo === 'historico') {
            titulo.innerText = "üìú Hist√≥rico de Aventuras";
            dadosCapital.historico.forEach((cap, index) => {
                container.innerHTML += `
                    <div class="item-menu" onclick="lerCapitulo(${index})" style="cursor: pointer; align-items: center;">
                        <div class="foto-placeholder" style="width: 50px; height: 50px; font-size: 20px;">üìñ</div>
                        <div class="texto-item">
                            <h4 style="margin-top: 10px;">${cap.titulo}</h4>
                            <p style="font-size: 12px; color: #aaa;">Clique para ler</p>
                        </div>
                    </div>`;
            });
            return;
        }

        // --- ABA ESQUADR√ÉO E PROCURADOS ---
        const lista = (tipo === 'esquadrao') ? dadosCapital.esquadrao : dadosCapital.procurados;
        titulo.innerText = (tipo === 'esquadrao') ? "üõ°Ô∏è Os Pandem√¥nios" : "‚ò†Ô∏è Cartazes de Procurados";

        lista.forEach(item => {
            let htmlImagem = item.foto 
                ? `<img src="${item.foto}" class="foto-lista" onclick="verImagemPersonagem('${item.foto}')" style="cursor: zoom-in;" title="Clique para ampliar">` 
                : `<div class="foto-placeholder">${tipo === 'esquadrao' ? 'RETRATO' : 'WANTED'}</div>`;

            let htmlSubtitulo = (tipo === 'esquadrao')
                ? `<span class="classe-char">${item.classe} ‚Ä¢ ${item.raca || 'Desconhecido'}</span>`
                : `<span class="recompensa">üí∞ ${item.recompensa}</span>`;

            container.innerHTML += `
                <div class="item-menu">
                    ${htmlImagem}
                    <div class="texto-item">
                        <h4>${item.nome}</h4>
                        ${htmlSubtitulo}
                        <p>${item.desc}</p>
                    </div>
                </div>`;
        });
    }

// --- FUN√á√ÉO: MENU DO PANTE√ÉO (ATUALIZADA) ---
    function menuDeuses() {
        const modal = document.getElementById('modal-capital');
        const container = document.getElementById('conteudo-menu-capital');
        const titulo = document.getElementById('titulo-menu-capital');
        modal.style.display = 'flex';
        
        titulo.innerText = "‚ö° Pante√£o dos 12 Deuses";
        let html = `<div class="grid-deuses">`;
        
        dadosGerais.deuses.forEach(deus => {
            // Se tiver foto, usa ela. Se n√£o, usa um placeholder cinza.
            const htmlImagem = deus.foto 
                ? `<img src="${deus.foto}" class="foto-deus-thumb">`
                : `<div class="foto-deus-thumb" style="background:#333; display:flex; align-items:center; justify-content:center;">?</div>`;

            // Adiciona o onclick enviando o arquivo da foto
            html += `
                <div class="item-deus" onclick="verImagemDeus('${deus.foto}')">
                    ${htmlImagem}
                    <span class="nome-deus">${deus.nome}</span>
                    <span class="desc-deus">${deus.titulo}</span>
                    <span class="dominio-deus">${deus.raca}</span>
                </div>`;
        });
        
        html += `</div>`;
        container.innerHTML = html;
    }

    // --- NOVA: LER O CAP√çTULO ---
    function lerCapitulo(index) {
        const container = document.getElementById('conteudo-menu-capital');
        const cap = dadosCapital.historico[index];
        
        // Bot√£o de Voltar para a lista de cap√≠tulos
        let html = `<button onclick="menuCapital('historico')" class="btn-popup" style="margin-bottom: 15px; background: #444;">‚¨Ö Voltar √† Lista</button>`;
        
        html += `<h3 style="color: #ffdead; border-bottom: 1px dashed #555; padding-bottom: 10px;">${cap.titulo}</h3>`;
        html += `<div class="texto-capitulo">${cap.texto}</div>`;
        
        container.innerHTML = html;
    }

// --- FUN√á√ÉO PARA VER IMAGEM DOS DEUSES ---
    function verImagemDeus(arquivo) {
        if (!arquivo) return; // Se n√£o tiver foto, n√£o faz nada

        // Esconde tudo
        document.getElementById('modal-capital').style.display = 'none';
        document.getElementById('map-container').style.display = 'none';
        document.getElementById('menu-provincias').style.display = 'none';

        // Prepara visualiza√ß√£o
        const containerImg = document.getElementById('provincia-container');
        containerImg.style.display = 'flex'; 
        document.getElementById('img-provincia').src = arquivo;

        // Bot√£o voltar ESPEC√çFICO para o menu de Deuses
        const btnVoltar = document.createElement('button');
        btnVoltar.innerHTML = "‚¨Ö Voltar ao Pante√£o";
        btnVoltar.className = "btn-popup";
        btnVoltar.style.cssText = "position: absolute; top: 20px; left: 20px; font-size: 16px; z-index: 4000; padding: 10px 20px;";
        
        btnVoltar.onclick = function() {
            containerImg.style.display = 'none';
            document.getElementById('map-container').style.display = 'block';
            
            // Restaura menu lateral se estiver no continente
            if (mapaAtualAtivo === 'continente') {
                document.getElementById('menu-provincias').style.display = 'block';
            }

            // Reabre o modal j√° carregando os deuses
            document.getElementById('modal-capital').style.display = 'flex';
            menuDeuses(); 
        };

        const btnAntigo = containerImg.querySelector('button');
        if (btnAntigo) containerImg.removeChild(btnAntigo);
        containerImg.insertBefore(btnVoltar, containerImg.firstChild);
    }

// --- FUN√á√ÉO PARA VER IMAGEM NO HIST√ìRICO (CORRIGIDA) ---
    function verImagemHistoria(arquivo, capituloIndex) {
        document.getElementById('modal-capital').style.display = 'none';
        document.getElementById('map-container').style.display = 'none';
        document.getElementById('menu-provincias').style.display = 'none'; // Esconde menu

        const containerImg = document.getElementById('provincia-container');
        containerImg.style.display = 'flex'; 
        document.getElementById('img-provincia').src = arquivo;

        const btnVoltar = document.createElement('button');
        btnVoltar.innerHTML = "‚¨Ö Voltar ao Texto";
        btnVoltar.className = "btn-popup";
        btnVoltar.style.cssText = "position: absolute; top: 20px; left: 20px; font-size: 16px; z-index: 4000; padding: 10px 20px;";
        
        btnVoltar.onclick = function() {
            containerImg.style.display = 'none';
            document.getElementById('map-container').style.display = 'block';
            
            // --- CORRE√á√ÉO: Restaura o menu se estiver no continente ---
            if (mapaAtualAtivo === 'continente') {
                document.getElementById('menu-provincias').style.display = 'block';
            }

            document.getElementById('modal-capital').style.display = 'flex';
            lerCapitulo(capituloIndex);
        };

        const btnAntigo = containerImg.querySelector('button');
        if (btnAntigo) containerImg.removeChild(btnAntigo);
        containerImg.insertBefore(btnVoltar, containerImg.firstChild);
    }

    // --- NOVA FUN√á√ÉO PARA AMPLIAR FOTO DO PERSONAGEM ---
// --- FUN√á√ÉO PARA AMPLIAR FOTO DO PERSONAGEM (CORRIGIDA) ---
    function verImagemPersonagem(arquivo) {
        document.getElementById('modal-capital').style.display = 'none';
        document.getElementById('map-container').style.display = 'none';
        document.getElementById('menu-provincias').style.display = 'none'; // Esconde menu

        const containerImg = document.getElementById('provincia-container');
        containerImg.style.display = 'flex'; 
        document.getElementById('img-provincia').src = arquivo;

        const btnVoltar = document.createElement('button');
        btnVoltar.innerHTML = "‚¨Ö Voltar ao Menu";
        btnVoltar.className = "btn-popup";
        btnVoltar.style.cssText = "position: absolute; top: 20px; left: 20px; font-size: 16px; z-index: 4000; padding: 10px 20px;";
        
        btnVoltar.onclick = function() {
            containerImg.style.display = 'none';
            document.getElementById('map-container').style.display = 'block';
            
            // --- CORRE√á√ÉO: Restaura o menu se estiver no continente ---
            if (mapaAtualAtivo === 'continente') {
                document.getElementById('menu-provincias').style.display = 'block';
            }

            document.getElementById('modal-capital').style.display = 'flex';
        };

        const btnAntigo = containerImg.querySelector('button');
        if (btnAntigo) containerImg.removeChild(btnAntigo);
        containerImg.insertBefore(btnVoltar, containerImg.firstChild);
    }
    // Nova fun√ß√£o que apenas fecha a foto sem resetar o mapa
    function fecharImagem() {
        document.getElementById('provincia-container').style.display = 'none';
        document.getElementById('map-container').style.display = 'block';
        
        // Se estiver no continente, garante que o menu aparece. 
        // Se estiver em prov√≠ncia, o menu continua escondido (como deve ser).
        if (mapaAtualAtivo === 'continente') {
            document.getElementById('menu-provincias').style.display = 'block';
        }
    }

    function fecharModais() { 
        document.getElementById('modal-info').style.display = 'none';
        document.getElementById('modal-capital').style.display = 'none';
    }
    
    // TRUQUE: Isso garante que se o HTML chamar 'fecharModalInfo', ele usa a nova fun√ß√£o
    window.fecharModalInfo = fecharModais;

    function abrirModalInfo() {
        const dados = dadosProvincias[mapaAtualAtivo] || dadosProvincias['default'];
        document.getElementById('titulo-provincia').innerHTML = dados.titulo;
        document.getElementById('texto-provincia').innerHTML = dados.descricao;
        document.getElementById('modal-info').style.display = 'flex';
    }

    function abrirMapaProvincia(arquivo) {
        mapaAtualAtivo = arquivo;
        document.getElementById('menu-provincias').style.display = 'none';
        document.getElementById('map-container').style.display = 'block';
        document.getElementById('provincia-container').style.display = 'none';

        inicializarMapa(arquivo, configProvincia.largura, configProvincia.altura, configProvincia.minZoom, configProvincia.maxZoom);

        // Bot√£o Voltar (Topo Esquerdo)
        const BotaoVoltarControl = L.Control.extend({
            options: { position: 'topleft' },
            onAdd: function() {
                const btn = L.DomUtil.create('button', 'leaflet-control-button-voltar');
                btn.innerHTML = "‚¨Ö Voltar ao Continente";
                btn.style.cssText = "white-space:nowrap; padding:12px 18px; background:#8b4513; color:white; border:2px solid #5e2f0d; border-radius:5px; cursor:pointer; font-weight:bold; font-size:14px; z-index:9999;";
                btn.onclick = function(e) {
                    L.DomEvent.stopPropagation(e);
                    carregarMapaPrincipal();
                };
                return btn;
            }
        });
        map.addControl(new BotaoVoltarControl());

        // Bot√£o Detalhes (Topo Direito)
        const BotaoInfoControl = L.Control.extend({
            options: { position: 'topright' },
            onAdd: function() {
                const btn = L.DomUtil.create('button', '');
                btn.innerHTML = "üìú Detalhes";
                btn.style.cssText = "white-space:nowrap; padding:10px 15px; background:#2c3e50; color:#cd853f; border:2px solid #cd853f; border-radius:5px; cursor:pointer; font-weight:bold;";
                btn.onclick = abrirModalInfo;
                return btn;
            }
        });
        map.addControl(new BotaoInfoControl());

        adicionarMarcadoresLocais(arquivo);
    }

function verImagemEstatica(arquivo) {
        // Esconde o mapa (mas ele continua vivo no fundo)
        document.getElementById('map-container').style.display = 'none';
        document.getElementById('menu-provincias').style.display = 'none'; // Esconde menu pra n√£o atrapalhar a foto
        document.getElementById('provincia-container').style.display = 'flex'; 
        document.getElementById('img-provincia').src = arquivo;
        
        const btnVoltarImg = document.createElement('button');
        btnVoltarImg.innerHTML = "‚¨Ö Voltar";
        btnVoltarImg.className = "btn-popup";
        // Ajustado para o topo
        btnVoltarImg.style.cssText = "position: absolute; top: 20px; left: 20px; font-size: 16px; z-index: 4000; padding: 10px 20px;";
        
        // AQUI EST√Å A MUDAN√áA M√ÅGICA:
        btnVoltarImg.onclick = fecharImagem; 
        
        const container = document.getElementById('provincia-container');
        const btnAntigo = container.querySelector('button');
        if (btnAntigo) container.removeChild(btnAntigo);
        container.insertBefore(btnVoltarImg, container.firstChild);
    }

    function voltarParaMapa() {
        if (mapaAtualAtivo === 'continente') carregarMapaPrincipal();
        else abrirMapaProvincia(mapaAtualAtivo);
    }

    // --- 6. MARCADORES LOCAIS ---
    function adicionarMarcadoresLocais(nomeDoMapa) {
        const iconP = L.icon({iconUrl: 'https://unpkg.com/leaflet@1.9.4/dist/images/marker-icon.png', iconSize: [50, 50], iconAnchor: [25, 25], popupAnchor: [0, -25]});
        const iconG = L.icon({iconUrl: 'https://unpkg.com/leaflet@1.9.4/dist/images/marker-icon.png', iconSize: [100, 100], iconAnchor: [50, 50], popupAnchor: [0, -50]});

// Fun√ß√£o interna para criar os pontos (ATUALIZADA)
        function criarPontoLocal(coord, nome, info, foto = null, grande = false, botaoExtra = null) {
            const m = L.marker(coord, {icon: grande ? iconG : iconP, opacity: 0}).addTo(map);
            let popupHtml = `<div style="text-align:center;"><b>${nome}</b><br><small>${info}</small>`;
            
            if (foto) {
                popupHtml += `<div style="margin-top: 10px;"><button onclick="verImagemEstatica('${foto}')" class="btn-popup">Ver Foto</button></div>`;
            }
            // NOVO: Adiciona bot√£o extra se existir
            if (botaoExtra) {
                popupHtml += `<div style="margin-top: 5px;">${botaoExtra}</div>`;
            }
            
            popupHtml += `</div>`;
            m.bindPopup(popupHtml);
        }

        if (nomeDoMapa === 'Hukmal_tep.jpg') {
            criarPontoLocal([1396, 780], "Capital de Hukmal'tep", "Felista", "C√≥pia de capital de hukmal_tep.png", true);
            criarPontoLocal([1422, 441], "Torre de Vigia", "Felista");
            criarPontoLocal([1209, 520], "Torre de Vigia", "Felista");
            criarPontoLocal([1488, 1081], "Torre de Vigia", "Felista");
            criarPontoLocal([1222, 1158], "Torre de Vigia", "Felista");
            criarPontoLocal([1474, 546], "Porto", "Felista");
            criarPontoLocal([1256, 1129], "Vilarejo", "Felista");
            criarPontoLocal([1106, 505], "Vilarejo", "Felista");
            criarPontoLocal([157, 267], "Cidade", "Garra do Inverno");
            criarPontoLocal([419, 483], "Vilarejo", "Garra do Inverno");
            criarPontoLocal([242, 1338], "Vilarejo", "Garra do Inverno", "C√≥pia de cidade ponte.png", true);
            criarPontoLocal([369, 868], "Vilarejo", "Garra do inverno", "C√≥pia de Cidade neve 3.png", true);
            criarPontoLocal([268, 1472], "Torre de Vigia", "Malista");
            criarPontoLocal([513, 1617], "Cidade", "Malista", "C√≥pia de Cidade neve 5.png", true);
            criarPontoLocal([534, 1918], "Vilarejo", "Malista");
            criarPontoLocal([530, 1710], "Porto", "Malista");
            criarPontoLocal([678, 101], "Porto", "Malista");
            criarPontoLocal([707, 1520], "Vilarejo", "Malista");
            criarPontoLocal([659, 1127], "Vilarejo", "Malista", "C√≥pia de Cidade neve 4.png", true);
            criarPontoLocal([796, 1134], "Torre de Vigia", "Malista");
            criarPontoLocal([960, 1733], "Torre de Vigia", "Malista");
            criarPontoLocal([1113, 1460], "Vilarejo", "Malista");
            criarPontoLocal([1003, 172], "Vilarejo", "Malista");
            criarPontoLocal([673, 640], "Vilarejo", "Malista", "C√≥pia de cidade drag√£o.png", true);
            criarPontoLocal([621, 358], "Torre de Vigia", "Malista");
            criarPontoLocal([740, 452], "Torre de Vigia", "Malista");
            criarPontoLocal([713, 257], "Cidade Malista", "Malista", "C√≥pia de Cidade portuaria gelo.png", true);
            criarPontoLocal([141, 578], "Vilarejo", "Neutro", "inicial.png", true);
            criarPontoLocal([1184, 1014], "Vilarejo", "Neutro");
        }

        if (nomeDoMapa === 'Blat_khyr.jpg') {
           // ATUALIZADO: Pede senha "poder", se acertar abre "bloqueado.jpg"
            const btnEscola = `<button onclick="abrirModalSenha('poder', 'bloqueado.jpg', 'imagem')" class="btn-popup" style="background:#800080;">üéì Escola de Magia</button>`;
            criarPontoLocal([382, 1359], "Capital de Blat'khyr", "Elfos", "cidade magica.png", true, btnEscola);
            criarPontoLocal([986, 1239], "Vilarejo", "Desconhecido");
            criarPontoLocal([1091, 606], "Vilarejo", "Desconhecido");
            criarPontoLocal([1463, 1151], "Vilarejo", "Desconhecido");
            criarPontoLocal([491, 371], "Cidade", "Elfos", "Cidade portu√°ria 4.png", true);
            criarPontoLocal([741, 963], "Cidade", "Elfos", "Cidade portu√°ria.png", true);
            criarPontoLocal([621, 1760], "Cidade", "Elfos", "Cidade portu√°ria 2.png", true);
            criarPontoLocal([69, 1054], "Cidade", "Elfos", "Cidade portu√°ria 3.png", true);
            criarPontoLocal([408, 745], "Cidade", "Elfos", "Cidade portu√°ria 5.webp", true);
            criarPontoLocal([252, 891], "Cidade", "Elfos", "Cidade portu√°ria 6.jpg", true);
            criarPontoLocal([611, 1210], "Vilarejo", "Humanos", "Vila.png", true);
            criarPontoLocal([530, 1149], "Vilarejo", "Humanos");
            criarPontoLocal([556, 850], "Vilarejo", "Humanos");
            criarPontoLocal([641, 641], "Vilarejo", "Humanos");
            criarPontoLocal([256, 1302], "Vilarejo", "Humanos");
            criarPontoLocal([500, 1644], "Vilarejo", "Humanos");
            criarPontoLocal([273, 1366], "Cidade", "Elfos");
            criarPontoLocal([824, 894], "Muralha", "Elfos");
            criarPontoLocal([791, 648], "Muralha", "Elfos");
            criarPontoLocal([766, 388], "Muralha", "Elfos");
            criarPontoLocal([884, 1094], "Muralha", "Elfos");
            criarPontoLocal([882, 1271], "Muralha", "Elfos");
        }
         if (nomeDoMapa === 'Deserto.jpg') {
            criarPontoLocal([240, 762], "Capital do Deserto", "Zha-Ruk", "Capital deserto.png", true);
            criarPontoLocal([1314, 588], "Vilarejo", "Ghovar", "Vila deserto.png", true);
            criarPontoLocal([1422, 1582], "Vilarejo", "Ghovar", "Vila de areia.png", true);
            criarPontoLocal( [1256, 126], "Minera√ß√£o", "Ghovar");
            criarPontoLocal( [1436, 112], "Minera√ß√£o", "Abandonada");
            criarPontoLocal( [1362, 400], "Minera√ß√£o", "Ghovar");
            criarPontoLocal( [1247, 730], "Minera√ß√£o", "Ghovar");
            criarPontoLocal( [1213, 846], "Minera√ß√£o", "Ghovar");
            criarPontoLocal( [1256, 126], "Minera√ß√£o", "Ghovar");
            criarPontoLocal( [1408, 1727], "Minera√ß√£o", "Abandonada");
            criarPontoLocal( [1363, 1855], "Minera√ß√£o", "Ghovar");
            criarPontoLocal( [1217, 1298], "Minera√ß√£o", "Abandonada");
            criarPontoLocal( [1149, 1784], "Minera√ß√£o", "Abandonada");
            criarPontoLocal(  [1049, 1809], "Minera√ß√£o", "Abandonada");
            criarPontoLocal( [1142, 1921], "Minera√ß√£o", "Abandonada");
            criarPontoLocal( [693, 1510], "Minera√ß√£o", "Ghovar");
            criarPontoLocal( [871, 1533], "Minera√ß√£o", "Ghovar");
            criarPontoLocal( [786, 1775], "Minera√ß√£o", "Ghovar");
            criarPontoLocal( [1032, 365], "Minera√ß√£o", "Ghovar");
            criarPontoLocal( [990, 617], "Minera√ß√£o", "Ghovar");
            criarPontoLocal(  [808, 580], "Minera√ß√£o", "Ghovar");
            criarPontoLocal(  [813, 399], "Minera√ß√£o", "Ghovar");
            criarPontoLocal( [475, 566], "Minera√ß√£o", "Abandonada");
            criarPontoLocal( [326, 539], "Minera√ß√£o", "Abandonada");
            criarPontoLocal( [401, 376], "Minera√ß√£o", "Ghovar");
        
            criarPontoLocal([1082, 1619], "Cidade", "Samum", "Cidade an√£.png", true);
            criarPontoLocal([1434, 312], "Cidade", "Samum", "Cidade deserto.png", true);
            criarPontoLocal([1082, 146], "Cidade", "Samum", "Cidade deserto 2.png", true);
            criarPontoLocal( [752, 536], "Cidade", "Samum", "Cidade enterrada 2.png", true);
            criarPontoLocal( [148, 170], "Cidade", "Samum");
            criarPontoLocal( [188, 1910], "Cidade", "Samum");

            criarPontoLocal( [1394, 814], "Ru√≠nas", "Atarim", "Entrada deserto.png", true);
            criarPontoLocal( [920, 662], "Ru√≠nas", "Atarim", "paisagem.png", true);
            criarPontoLocal( [660, 1652], "Ru√≠nas", "Atarim");
            criarPontoLocal(  [1310, 1502], "Ru√≠nas", "Atarim");

            criarPontoLocal( [792, 912], "Castelo", "Zha-Ruk", "Castelo deserto 1.png", true);
            criarPontoLocal( [1394, 915], "Castelo", "Zha-Ruk", "Castelo deserto 2.png", true);
            criarPontoLocal( [332, 1278], "Castelo", "Zha-Ruk");
            criarPontoLocal( [1020, 1188], "Castelo", "Zha-Ruk");
            criarPontoLocal( [1210, 1118], "Torre de Vigia", "Zha-Ruk");
            criarPontoLocal(  [1432, 1196], "Torre de Vigia", "Zha-Ruk");

        }
         if (nomeDoMapa === 'Lago.jpg') {
            criarPontoLocal([970, 1152], "Templo do Lago", "Guardi√µes do Templo", "Templo do lago.png", true);
            const btnPanteao = `<button onclick="menuDeuses()" class="btn-popup" style="background:#4682B4;">‚ö° Pante√£o</button>`;
            criarPontoLocal([1366, 1578], "Cidade Sagrada", "Igreja dos 12 Deuses", "Cidade Santa.png", true, btnPanteao);
            criarPontoLocal([1336, 1740], "Cidade Sagrada", "Igreja dos 12 Deuses", "Cidade Santa.png", true, btnPanteao);
            criarPontoLocal([446, 1336], "Vilarejo", "Dinastia Xogum");
            const btnNinja = `<button onclick="abrirModalSenha('ninja', 'bloqueado.jpg', 'imagem')" class="btn-popup" style="background: #2E8B57; border: 1px solid #555; margin-top: 5px;">üîç Descobrir</button>`;
            criarPontoLocal([180, 912], "Cidade", "Dinastia Xogum", "cidade lago 1.png", true, btnNinja);
            criarPontoLocal([898, 1908], "Cidade", "Dinastia Kemono", "capital do lago.png", true); 
            criarPontoLocal([726, 1366], "Cidade", "Dinastia Kemono", "cidade lago 2.png", true); //imagem beira do lago
            criarPontoLocal([948, 1672], "Vilarejo", "Dinastia Kemono");
            criarPontoLocal([980, 818], "Cidade", "Dinastia Kitsune", "cidade na montanha.png", true); //imagem beira do lago
            criarPontoLocal([1014, 92], "Vilarejo", "Dinastia Kitsune", "vilarejo na montanha.png", true);
            criarPontoLocal( [610, 706], "Vilarejo", "Dinastia Kitsune");
            criarPontoLocal( [1190, 532], "Vilarejo", "Dinastia Kitsune", "templo.png", true);
            criarPontoLocal( [1400, 192], "Vilarejo", "Dinastia Kitsune");
            criarPontoLocal( [1370, 1016], "Vilarejo", "Dinastia Kitsune");
            criarPontoLocal( [534, 400], "Vilarejo", "Dinastia Seilor");
            criarPontoLocal( [786, 460], "Cidade", "Dinastia Seilor", "cidade lago 3.png", true); //imagem com porto

 
        }

         if (nomeDoMapa === 'Alcova.jpg') {
            criarPontoLocal( [1326, 782], "Torre de Vigia", "Marinha Imperial");
            criarPontoLocal( [1175, 1185], "Torre de Vigia", "Marinha Imperial");
            criarPontoLocal( [1228, 1740], "Torre de Vigia", "Marinha Imperial");
            criarPontoLocal( [724, 650], "Torre de Vigia", "Marinha Imperial");
            criarPontoLocal( [850, 1007], "Torre de Vigia", "Marinha Imperial");
            criarPontoLocal(  [835, 1426], "Torre de Vigia", "Marinha Imperial");
            criarPontoLocal(  [778, 1526], "Torre de Vigia", "Marinha Imperial");

            criarPontoLocal(  [1333, 845], "Cidade", "Desconhecido");
            criarPontoLocal(  [1178, 1137], "Cidade", "Desconhecido");
            criarPontoLocal(  [1191, 1770], "Cidade", "Desconhecido");
            criarPontoLocal(  [637, 1817], "Cidade", "Desconhecido");
            criarPontoLocal(   [565, 1781], "Cidade", "Desconhecido");
            criarPontoLocal(  [814, 1010], "Cidade", "Desconhecido");
            criarPontoLocal(   [775, 643], "Cidade", "Desconhecido");
            criarPontoLocal(   [693, 612], "Cidade", "Desconhecido");
            criarPontoLocal(  [570, 285], "Cidade", "Desconhecido");
            criarPontoLocal(   [210, 344], "Cidade", "Desconhecido");
            criarPontoLocal(  [344, 1175], "Cidade", "Desconhecido");
            criarPontoLocal(   [1133, 536], "Cidade", "Desconhecido");
            criarPontoLocal(    [994, 437], "Cidade", "Desconhecido");

            criarPontoLocal( [904, 269], "Cidade", "Desconhecido", "Cidade pirata.png", true);
            criarPontoLocal(  [333, 1571], "Cidade", "Desconhecido");
            criarPontoLocal( [291, 1628], "Cidade", "Desconhecido");
            criarPontoLocal( [1311, 391], "Cidade", "Desconhecido", "Cidade alcova.jpg", true);
            const btnDescobrir = `<button onclick="abrirModalSenha('mar', 'Mar.jpg')" class="btn-popup" style="background: #2E8B57; margin-top: 5px;">üîç Descobrir</button>`;
            criarPontoLocal([1052, 540], "Cidade", "Desconhecido", "Alcova.png", true, btnDescobrir);
            criarPontoLocal( [1131, 688], "Cidade", "Desconhecido", "Alcova 2.png", true);
            criarPontoLocal( [1189, 1455], "Cidade", "Desconhecido", "Alcova 3.png", true);
            criarPontoLocal( [1317, 1679], "Cidade", "Desconhecido");
            criarPontoLocal( [370, 736], "Cidade", "Desconhecido"); 
            criarPontoLocal(  [482, 1192], "Ilha dos Afogados", "Desconhecido", "lugar no mar.png", true);
            criarPontoLocal( [778, 1442], "Ilha Naval", "Marinha Imperial", "ilha naval.png", true);
            criarPontoLocal( [866, 1518], "Ilha Naval", "Marinha Imperial", "ilha naval.png", true);
            criarPontoLocal( [134, 1355], "Templo do Fim do Mundo", "Desconhecido", "Templo do fim do mundo.png", true);
          
 
        }
if (nomeDoMapa === 'Mar.jpg') {

            const btnSubir = `<button onclick="abrirMapaProvincia('Alcova.jpg')" class="btn-popup" style="background: #4682B4;">‚¨ÜÔ∏è Subir</button>`;
            criarPontoLocal([962, 444], "T√∫neis", "Passagem de volta para a superf√≠cie.", null, true, btnSubir);
            criarPontoLocal([772, 264], "T√∫neis", "Passagem de volta para a superf√≠cie.", null, true, btnSubir);
            criarPontoLocal([720, 948], "T√∫neis", "Passagem de volta para a superf√≠cie.", null, true, btnSubir);
            criarPontoLocal([834, 1404], "T√∫neis", "Passagem de volta para a superf√≠cie.", null, true, btnSubir);
            criarPontoLocal([1180, 1744], "T√∫neis", "Passagem de volta para a superf√≠cie.", null, true, btnSubir);
            
            criarPontoLocal( [1020, 954], "Cidade Submersa", "Desconhecido", "Cidade no mar.png", true);
            criarPontoLocal( [470, 538], "Cidade Submersa", "Desconhecido", "mais cidade no mar.png", true);
            criarPontoLocal( [982, 1826], "Cidade Submersa", "Desconhecido", "Cidade no mar 2.jpg", true);
            criarPontoLocal( [292, 1370], "Cidade Submersa", "Desconhecido");
        
        
        }
    }

// --- 7. MARCADORES DO CONTINENTE ---
    function adicionarMarcadoresPrincipais() {
        const iconP = L.icon({iconUrl: 'https://unpkg.com/leaflet@1.9.4/dist/images/marker-icon.png', iconSize: [80, 80], iconAnchor: [40, 40], popupAnchor: [0, -40]});
        const iconG = L.icon({iconUrl: 'https://unpkg.com/leaflet@1.9.4/dist/images/marker-icon.png', iconSize: [120, 120], iconAnchor: [60, 60], popupAnchor: [0, -60]});

        function criarPonto(coord, nome, arg3, arg4, arg5) {
            let descricao = "";
            let arquivo = "";
            let tipo = "";
            let grande = false;

            if (arg3 && (arg3.includes('.png') || arg3.includes('.jpg') || arg3.includes('.webp') || arg3 === null)) {
                arquivo = arg3; tipo = arg4; grande = arg5 || false;
            } else {
                descricao = arg3; arquivo = arg4; tipo = arg5;
            }

            const m = L.marker(coord, { icon: grande ? iconG : iconP, opacity: 0 }).addTo(map);
            let botoes = "";

            // --- CAPITAL IMPERIAL ---
            if (nome === "Capital Imperial") {
                if (arquivo) botoes += `<button onclick="verImagemEstatica('${arquivo}')" class="btn-popup" style="margin-bottom:5px;">üì∏ Ver Cidade</button>`;
                botoes += `<button onclick="menuCapital('esquadrao')" class="btn-popup" style="background:#2c3e50; margin-bottom:5px;">üõ°Ô∏è Ver Esquadr√£o</button>`;
                botoes += `<button onclick="menuCapital('procurados')" class="btn-popup" style="background:#8b0000; margin-bottom:5px;">‚ò†Ô∏è Procurados</button>`;
                botoes += `<button onclick="menuCapital('historico')" class="btn-popup" style="background:#5e2f0d; margin-bottom:5px;">üìú Hist√≥rico</button>`;
                botoes += `<button onclick="menuCapital('boatos')" class="btn-popup" style="background:#4b0082; margin-bottom:5px;">üó£Ô∏è Boatos</button>`;
                // NOVO: BANCO
                botoes += `<button onclick="menuCapital('banco')" class="btn-popup" style="background:#DAA520; color: black;">üè¶ Banco Imperial</button>`;
            }
            
            // --- CIDADE SAGRADA (CONTINENTE) ---
            else if (nome === "Cidade Sagrada") {
                if (arquivo) botoes += `<button onclick="verImagemEstatica('${arquivo}')" class="btn-popup" style="margin-bottom:5px;">üì∏ Ver Cidade</button>`;
                // NOVO: PANTE√ÉO
                botoes += `<button onclick="menuDeuses()" class="btn-popup" style="background:#4682B4;">‚ö° Pante√£o</button>`;
            }

// --- TORRE DOS S√ÅBIOS ---
            else if (nome === "Torre dos S√°bios") {
                if (arquivo) {
                    botoes += `<button onclick="verImagemEstatica('${arquivo}')" class="btn-popup" style="margin-bottom:5px;">üì∏ Ver Exterior</button>`;
                }
                // ATUALIZADO: Pede senha "fofoca", se acertar abre "bloqueado.jpg"
                botoes += `<button onclick="abrirModalSenha('fofoca', 'bloqueado.jpg', 'imagem')" class="btn-popup" style="background:#483D8B;">üîÆ Acessar Interior</button>`;
            }

            // --- PADR√ÉO ---
            else {
                if (tipo === 'mapa') botoes = `<button onclick="abrirMapaProvincia('${arquivo}')" class="btn-popup">Explorar Prov√≠ncia</button>`;
                else if (tipo === 'imagem') botoes = `<button onclick="verImagemEstatica('${arquivo}')" class="btn-popup">Ver Foto</button>`;
                else botoes = `<span style="color:#aaa; font-style:italic;">Sem detalhes.</span>`;
            }

            let conteudoPopup = `<div style="text-align:center;"><b>${nome}</b>`;
            if (descricao) conteudoPopup += `<br><small style="color:#ccc;">${descricao}</small>`;
            conteudoPopup += `<div style="margin-top: 12px;">${botoes}</div></div>`;
            m.bindPopup(conteudoPopup);
        }

        // PONTOS (MANTIVE SEUS PONTOS ORIGINAIS)
        criarPonto([824, 2330], "Deserto","A Origem do Mundo", "Deserto.jpg", 'mapa');
        criarPonto([3850, 3580], "Hukmal'tep", "O Inverno Absoluto","Hukmal_tep.jpg", 'mapa');
        criarPonto([2902, 5464], "Blat'khyr", "O Ber√ßo da Magia", "Blat_khyr.jpg", 'mapa');
        criarPonto([1118, 4346], "Lago", "O Solo Aben√ßoado", "Lago.jpg", 'mapa');
        criarPonto([1356, 3284], "Alcova","O Lar dos Piratas", "Alcova.jpg", 'mapa');
        criarPonto([2250, 4258], "Espinha do Gigante", "As Terras Altas", "Espinha do Gigante.jpg", 'mapa', true);
        criarPonto([2142, 4378], "Espinha do Gigante","As Terras Altas", "Espinha do Gigante.jpg", 'mapa', true);
        criarPonto([2370, 3767], "Capital Imperial", "A Casa do Imp√©rio", "Capital.png", 'imagem');
        criarPonto([1648, 4438], "Cidade Sagrada", "Cidade Santa.png", 'imagem');
        criarPonto([2862, 2890], "Torre dos S√°bios", "Torre dos Sabios.png", 'imagem');
        criarPonto([1188, 5574], "Ilha Paradis√≠aca", "ilha 2.png", 'imagem');
        criarPonto([1830, 2322], "Vilarejo", "cidade da ra√ßa l√°.png", 'imagem');
        criarPonto([2114, 3854], "Vilarejo", "vilarejo.png", 'imagem');
        criarPonto([2142, 3254], "Vilarejo", "vilarejo 2.jpg", 'imagem');
        criarPonto([1758, 4620], "Vilarejo", "vilarejo 3.jpg", 'imagem');
        criarPonto([2252, 2880], "P√¢ntano", "pantano.png", 'imagem');
        criarPonto([2138, 2890], "P√¢ntano", "pantano.png", 'imagem');
        criarPonto([2228, 3032], "P√¢ntano", "pantano.png", 'imagem');
        criarPonto([2220, 2656], "P√¢ntano", "pantano.png", 'imagem');
        criarPonto([2232, 3936], "Vilarejo", null, 'none');
        criarPonto([2300, 3400], "Vilarejo", null, 'none');
        criarPonto([1830, 4354], "Vilarejo", null, 'none');
        criarPonto([1630, 3054], "Vilarejo", null, 'none');
        criarPonto([2464, 4974], "Ilha de Blat'khyr", "Cad√™?", "Ilha.png", 'imagem');
        criarPonto([1838, 3526], "Floresta dos Sonhos", "floresta dos sonhos.png", 'imagem');
        criarPonto([1750, 3320], "Floresta dos Sonhos", "floresta dos sonhos.png", 'imagem');
        criarPonto([1536, 3634], "Floresta dos Sonhos", "floresta dos sonhos.png", 'imagem');
        criarPonto([2070, 3642], "Floresta dos Sonhos", "floresta dos sonhos.png", 'imagem');
        criarPonto([3912, 1780], "Inverno Desolado", null, 'none', true);
    }
    // Inicializa√ß√£o
    carregarMapaPrincipal();
    </script>
</body>
</html>